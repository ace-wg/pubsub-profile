<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Publish-Subscribe Profile for Authentication and Authorization for Constrained Environments (ACE)</title>
<meta content="Francesca Palombini" name="author">
<meta content="Cigdem Sengul" name="author">
<meta content="Marco Tiloca" name="author">
<meta content='
       This document defines an application profile of the Authentication and Authorization for Constrained Environments (ACE) framework, to enable secure group communication in the Publish-Subscribe (Pub-Sub) architecture for the Constrained Application Protocol (CoAP) [draft-ietf-core-coap-pubsub], where Publishers and Subscribers communicate through a Broker. This profile relies on protocol-specific transport profiles of ACE to achieve communication security, server authentication, and proof-of-possession for a key owned by the Client and bound to an OAuth 2.0 access token. This document specifies the provisioning and enforcement of authorization information for Clients to act as Publishers and/or Subscribers, as well as the provisioning of keying material and security parameters that Clients use for protecting their communications end-to-end through the Broker. 
       Note to RFC Editor: Please replace "[draft-ietf-core-coap-pubsub]" with the RFC number of that document and delete this paragraph. 
    ' name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-ace-pubsub-profile-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.12.8
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-ace-pubsub-profile.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">ACE Pub-Sub Profile</td>
<td class="right">February 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Palombini, et al.</td>
<td class="center">Expires 6 August 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ACE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-ace-pubsub-profile-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-02-02" class="published">2 February 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-08-06">6 August 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">C. Sengul</div>
<div class="org">Brunel University</div>
</div>
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Publish-Subscribe Profile for Authentication and Authorization for Constrained Environments (ACE)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines an application profile of the Authentication and Authorization for Constrained Environments (ACE) framework, to enable secure group communication in the Publish-Subscribe (Pub-Sub) architecture for the Constrained Application Protocol (CoAP) [draft-ietf-core-coap-pubsub], where Publishers and Subscribers communicate through a Broker. This profile relies on protocol-specific transport profiles of ACE to achieve communication security, server authentication, and proof-of-possession for a key owned by the Client and bound to an OAuth 2.0 access token. This document specifies the provisioning and enforcement of authorization information for Clients to act as Publishers and/or Subscribers, as well as the provisioning of keying material and security parameters that Clients use for protecting their communications end-to-end through the Broker.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">Note to RFC Editor: Please replace "[draft-ietf-core-coap-pubsub]" with the RFC number of that document and delete this paragraph.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    Authentication and Authorization for Constrained Environments Working Group mailing list (ace@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/ace/">https://mailarchive.ietf.org/arch/browse/ace/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/ace-wg/pubsub-profile">https://github.com/ace-wg/pubsub-profile</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 6 August 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-application-profile-overvie" class="internal xref">Application Profile Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-getting-authorisation-to-jo" class="internal xref">Getting Authorisation to Join a Pub-Sub security group (A)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-topic-discovery-at-the-brok" class="internal xref">Topic Discovery at the Broker (Optional)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-as-discovery-at-the-broker-" class="internal xref">AS Discovery at the Broker (Optional)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-kdc-discovery-at-the-broker" class="internal xref">KDC Discovery at the Broker (Optional)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-authorisation-request-respo" class="internal xref">Authorisation Request/Response for the KDC and the Broker</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-format-of-scope" class="internal xref">Format of Scope</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-authorization-response" class="internal xref">Authorization response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-token-transfer-to-the-kdc" class="internal xref">Token Transfer to the KDC</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-client-group-communication-" class="internal xref">Client Group Communication Interface at the KDC</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-joining-a-security-group" class="internal xref">Joining a Security Group</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-join-request" class="internal xref">Join Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-join-response" class="internal xref">Join Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="auto internal xref">4.1.3</a>.  <a href="#name-join-error-handling" class="internal xref">Join Error Handling</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-other-group-operations-thro" class="internal xref">Other Group Operations through the KDC</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-obtaining-latest-informatio" class="internal xref">Obtaining Latest Information on the Group, Group Keying Material, and Sender ID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-requesting-a-new-sender-id" class="internal xref">Requesting a New Sender ID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="auto internal xref">4.2.3</a>.  <a href="#name-updating-authentication-cre" class="internal xref">Updating Authentication Credentials</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="auto internal xref">4.2.4</a>.  <a href="#name-leaving-a-group" class="internal xref">Leaving a Group</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-group-rekeying-process" class="internal xref">Group Rekeying Process</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-pub-sub-protected-communica" class="internal xref">Pub-Sub Protected Communication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-using-cose-to-protect-the-p" class="internal xref">Using COSE to Protect the Published Topic Data</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-aead-nonce" class="internal xref">AEAD Nonce</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-replay-checks" class="internal xref">Replay Checks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-applicability-to-the-mqtt-p" class="internal xref">Applicability to the MQTT Pub-Sub Profile</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-ace-groupcomm-key-types" class="internal xref">ACE Groupcomm Key Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-ace-groupcomm-profiles" class="internal xref">ACE Groupcomm Profiles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-core-resource-type" class="internal xref">CoRE Resource Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-aif-media-type-sub-paramete" class="internal xref">AIF Media-Type Sub-Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="auto internal xref">9.5</a>.  <a href="#name-coap-content-formats" class="internal xref">CoAP Content-Formats</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-9.6" class="auto internal xref">9.6</a>.  <a href="#name-tls-exporter-labels" class="internal xref">TLS Exporter Labels</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-requirements-on-application" class="internal xref">Requirements on Application Profiles</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-mandatory-to-address-requir" class="internal xref">Mandatory-to-Address Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-optional-to-address-require" class="internal xref">Optional-to-Address Requirements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-document-updates" class="internal xref">Document Updates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-version-10-to-11" class="internal xref">Version -10 to -11</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-version-09-to-10" class="internal xref">Version -09 to -10</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-version-08-to-09" class="internal xref">Version -08 to -09</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#appendix-B.4" class="auto internal xref">B.4</a>.  <a href="#name-version-07-to-08" class="internal xref">Version -07 to -08</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#appendix-B.5" class="auto internal xref">B.5</a>.  <a href="#name-version-06-to-07" class="internal xref">Version -06 to -07</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">In a publish-subscribe (Pub-Sub) scenario, devices acting as Publishers and/or Subscribers  communicate via a Broker that enforces store-and-forward messaging between those. This effectively enables a form of group communication, where all the Publishers and Subscribers participating in the same Pub-Sub topic are considered members of the same application group associated with that topic.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">With a focus on the Pub-Sub architecture defined in <span>[<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span> for the Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, this document defines an application profile of the Authentication and Authorization for Constrained Environments (ACE) framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, which enables Pub-Sub communication where a group of Publishers and Subscribers securely communicate through a Broker using CoAP.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Building on the message formats and processing defined in <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, this document specifies the provisioning and enforcement of authorization information for Clients to act as Publishers and/or Subscribers at the Broker, as well as the provisioning of keying material and security parameters that Clients use for protecting end-to-end their communications via the Broker.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">In order to protect the Pub-Sub operations at the Broker as well as the provisioning of keying material and security parameters, this profile relies on protocol-specific transport profiles of ACE (e.g., <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span>, <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>, or <span>[<a href="#I-D.ietf-ace-edhoc-oscore-profile" class="cite xref">I-D.ietf-ace-edhoc-oscore-profile</a>]</span>) to achieve communication security, server authentication, and proof-of-possession for a key owned by the Client and bound to an OAuth 2.0 access token.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The content of published messages that are circulated by the Broker is protected end-to-end between the corresponding Publisher and the intended Subscribers. To this end, this profile relies on COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span><span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> and on keying material provided to the Publishers and Subscribers participating in the same Pub-Sub topic. In particular, source authentication of published content is achieved by means of the corresponding Publisher signing such content with its own private key.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">While this profile focuses on the Pub-Sub architecture for CoAP, <a href="#mqtt-pubsub" class="auto internal xref">Section 7</a> of this document describes how this profile can be applicable to MQTT <span>[<a href="#MQTT-OASIS-Standard-v5" class="cite xref">MQTT-OASIS-Standard-v5</a>]</span>. Similar adaptations can also extend to further transport protocols and Pub-Sub architectures.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with:<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.1">
            <p id="section-1.1-3.1.1">The terms and concepts described in the ACE framework for Authentication and Authorization <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. The terminology for entities in the considered architecture is defined in OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>. In particular, this includes Client, Resource Server (RS), and Authorization Server (AS).<a href="#section-1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.2">
            <p id="section-1.1-3.2.1">The Authorization Information Format (AIF) <span>[<a href="#RFC9237" class="cite xref">RFC9237</a>]</span> used to express authorization information.<a href="#section-1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.3">
            <p id="section-1.1-3.3.1">The terms and concept related to the message formats and processing specified in <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, for provisioning and renewing keying material in group communication scenarios. These include the abbreviations REQx and OPTx denoting the numbered mandatory-to-address and optional-to-address requirements, respectively.<a href="#section-1.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.4">
            <p id="section-1.1-3.4.1">The terms and concepts described in CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>, CBOR <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, and COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span><span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span><span>[<a href="#RFC9338" class="cite xref">RFC9338</a>]</span>.<a href="#section-1.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.5">
            <p id="section-1.1-3.5.1">The terms and concepts described in CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>. Note that the term "endpoint" is used here following its OAuth definition, aimed at denoting resources such as <code>/token</code> and <code>/introspect</code> at the AS, and <code>/authz-info</code> at the RS. This document does not use the CoAP definition of "endpoint", which is "An entity participating in the CoAP protocol".<a href="#section-1.1-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.6">
            <p id="section-1.1-3.6.1">The terms and concepts of Pub-Sub group communication with CoAP, as described in <span>[<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>.<a href="#section-1.1-3.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.1-4">A party interested in participating in group communication as well as already participating as a group member is interchangeably denoted as "Client", "Pub-Sub client", or "node".<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-5.1">
            <p id="section-1.1-5.1.1">Group: a set of nodes that share common keying material and security parameters to protect their communications with one another. That is, the term refers to a "security group".<a href="#section-1.1-5.1.1" class="pilcrow">¶</a></p>
<p id="section-1.1-5.1.2">
This is not to be confused with an "application group", which has relevance at the application level and whose members are in this case the Clients acting as Publishers and/or Subscribers for a topic.<a href="#section-1.1-5.1.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.1-6">Examples throughout this document are expressed in CBOR diagnostic notation as defined in <span><a href="https://rfc-editor.org/rfc/rfc8949#section-8" class="relref">Section 8</a> of [<a href="#RFC8949" class="cite xref">RFC8949</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc8610#appendix-G" class="relref">Appendix G</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>. Diagnostic notation comments are often used to provide a textual representation of the parameters' keys and values.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-application-profile-overvie">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-application-profile-overvie" class="section-name selfRef">Application Profile Overview</a>
      </h2>
<p id="section-2-1">This document describes how to use <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> and <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> to perform authentication, authorization, and key distribution operations as overviewed in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-2" class="relref">Section 2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, where the considered group is the security group composed of the Pub-Sub clients that exchange end-to-end protected content through the Broker.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Pub-Sub clients communicate within their application groups, each of which is mapped to a topic. Depending on the application, a topic may consist of one or more sub-topics, which in turn may have their own sub-topics and so on, thus forming a hierarchy. A security group <span class="bcp14">SHOULD</span> be associated with a single application group. However, the same application group <span class="bcp14">MAY</span> be associated with multiple security groups. Further details and considerations on the mapping between the two types of groups are out of the scope of this document.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">This profile considers the architecture shown in <a href="#archi" class="auto internal xref">Figure 1</a>. A Client can act as a Publisher, or a Subscriber, or both, e.g., by publishing to some topics and subscribing to others. However, for the simplicity of presentation, this profile describes Publisher and Subscriber Clients separately.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">Both Publishers and Subscribers act as ACE Clients. The Broker acts as an ACE RS, and corresponds to the Dispatcher in <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. The Key Distribution Center (KDC) also acts as an ACE RS, and builds on what is defined for the KDC in <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. From a high-level point of view, the Clients interact with the KDC in order to join security groups, thereby obtaining the group keying material to protect end-to-end and verify the content published in the associated topics.<a href="#section-2-4" class="pilcrow">¶</a></p>
<span id="name-architecture-for-pub-sub-wi"></span><div id="archi">
<figure id="figure-1">
        <div id="section-2-5.1">
          <div class="alignCenter art-svg artwork" id="section-2-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="320" width="400" viewBox="0 0 400 320" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,224 L 8,304" fill="none" stroke="black"></path>
              <path d="M 48,160 L 48,216" fill="none" stroke="black"></path>
              <path d="M 80,192 L 80,216" fill="none" stroke="black"></path>
              <path d="M 112,32 L 112,112" fill="none" stroke="black"></path>
              <path d="M 112,224 L 112,304" fill="none" stroke="black"></path>
              <path d="M 192,120 L 192,160" fill="none" stroke="black"></path>
              <path d="M 240,32 L 240,112" fill="none" stroke="black"></path>
              <path d="M 272,32 L 272,112" fill="none" stroke="black"></path>
              <path d="M 288,224 L 288,304" fill="none" stroke="black"></path>
              <path d="M 336,120 L 336,192" fill="none" stroke="black"></path>
              <path d="M 392,32 L 392,112" fill="none" stroke="black"></path>
              <path d="M 392,224 L 392,304" fill="none" stroke="black"></path>
              <path d="M 112,32 L 240,32" fill="none" stroke="black"></path>
              <path d="M 272,32 L 392,32" fill="none" stroke="black"></path>
              <path d="M 112,112 L 240,112" fill="none" stroke="black"></path>
              <path d="M 272,112 L 392,112" fill="none" stroke="black"></path>
              <path d="M 48,160 L 96,160" fill="none" stroke="black"></path>
              <path d="M 144,160 L 192,160" fill="none" stroke="black"></path>
              <path d="M 80,192 L 224,192" fill="none" stroke="black"></path>
              <path d="M 272,192 L 336,192" fill="none" stroke="black"></path>
              <path d="M 8,224 L 112,224" fill="none" stroke="black"></path>
              <path d="M 288,224 L 392,224" fill="none" stroke="black"></path>
              <path d="M 120,240 L 176,240" fill="none" stroke="black"></path>
              <path d="M 224,240 L 280,240" fill="none" stroke="black"></path>
              <path d="M 120,272 L 176,272" fill="none" stroke="black"></path>
              <path d="M 224,272 L 280,272" fill="none" stroke="black"></path>
              <path d="M 8,304 L 112,304" fill="none" stroke="black"></path>
              <path d="M 288,304 L 392,304" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="344,120 332,114.4 332,125.6" fill="black" transform="rotate(270,336,120)"></polygon>
              <polygon class="arrowhead" points="288,272 276,266.4 276,277.6" fill="black" transform="rotate(0,280,272)"></polygon>
              <polygon class="arrowhead" points="288,240 276,234.4 276,245.6" fill="black" transform="rotate(0,280,240)"></polygon>
              <polygon class="arrowhead" points="200,120 188,114.4 188,125.6" fill="black" transform="rotate(270,192,120)"></polygon>
              <polygon class="arrowhead" points="128,272 116,266.4 116,277.6" fill="black" transform="rotate(180,120,272)"></polygon>
              <polygon class="arrowhead" points="128,240 116,234.4 116,245.6" fill="black" transform="rotate(180,120,240)"></polygon>
              <polygon class="arrowhead" points="88,216 76,210.4 76,221.6" fill="black" transform="rotate(90,80,216)"></polygon>
              <polygon class="arrowhead" points="56,216 44,210.4 44,221.6" fill="black" transform="rotate(90,48,216)"></polygon>
              <g class="text">
                <text x="176" y="52">Authorization</text>
                <text x="328" y="52">Key</text>
                <text x="172" y="68">Server</text>
                <text x="332" y="68">Distribution</text>
                <text x="180" y="84">(AS)</text>
                <text x="332" y="84">Center</text>
                <text x="328" y="100">(KDC)</text>
                <text x="120" y="164">(A)</text>
                <text x="248" y="196">(B)</text>
                <text x="200" y="244">(O)</text>
                <text x="56" y="260">Pub-Sub</text>
                <text x="340" y="260">Broker</text>
                <text x="52" y="276">Client</text>
                <text x="200" y="276">(C)</text>
              </g>
            </svg><a href="#section-2-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-architecture-for-pub-sub-wi" class="selfRef">Architecture for Pub-Sub with Authorization Server and Key Distribution Center</a>
        </figcaption></figure>
</div>
<p id="section-2-6">Both Publishers and Subscribers <span class="bcp14">MUST</span> use the same protocol for interacting with the Broker and  participating in Pub-Sub communications. When using the profile defined in this document, such a protocol <span class="bcp14">MUST</span> be CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, which is used as described in <span>[<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>. What is specified in this document can apply to other protocols for Pub-Sub communications such as MQTT <span>[<a href="#MQTT-OASIS-Standard-v5" class="cite xref">MQTT-OASIS-Standard-v5</a>]</span>, or to further transport protocols.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">All Publishers and Subscribers <span class="bcp14">MUST</span> use CoAP when communicating with the KDC.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">Furthermore, both Publishers and Subscribers <span class="bcp14">MUST</span> use the same transport profile of ACE (e.g., <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span> for DTLS; or <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span> or <span>[<a href="#I-D.ietf-ace-edhoc-oscore-profile" class="cite xref">I-D.ietf-ace-edhoc-oscore-profile</a>]</span> for OSCORE) in their interaction with the Broker. In order to reduce the number of libraries that Clients have to support, it is <span class="bcp14">RECOMMENDED</span> that the same transport profile of ACE is used also for the interaction between the Clients and the KDC.<a href="#section-2-8" class="pilcrow">¶</a></p>
<p id="section-2-9">All communications between the involved entities <span class="bcp14">MUST</span> be secured.<a href="#section-2-9" class="pilcrow">¶</a></p>
<p id="section-2-10">For each Client, the Client and the Broker <span class="bcp14">MUST</span> have a secure communication association, which they establish with the help of the AS and using a transport profile of ACE. This is shown by the interactions A and C in <a href="#archi" class="auto internal xref">Figure 1</a>. During this process, the Client obtains an access token from the AS and uploads it to the Broker, thus providing an evidence of the topics that it is authorised to participate in, and with which permissions.<a href="#section-2-10" class="pilcrow">¶</a></p>
<p id="section-2-11">For each Client, the Client and the KDC <span class="bcp14">MUST</span> have a secure communication association, which they also establish with the help of the AS and using a transport profile of ACE. This is shown by the interactions A and B in <a href="#archi" class="auto internal xref">Figure 1</a>. During this process, the Client obtains an access token from the AS and uploads it to the KDC, thus providing an evidence of the security groups that it can join, as associated with the topics of interest at the Broker. Based on the permissions specified in the access token, the Client can request the KDC to join a security group, after which the Client obtains from the KDC the keying material to use for communicating with the other group members. This builds on the process for joining security groups with ACE, as defined in <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> and further specified in this document.<a href="#section-2-11" class="pilcrow">¶</a></p>
<p id="section-2-12">In addition, this profile allows an anonymous Client to perform some of the discovery operations defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-16#section-2.3" class="relref">Section 2.3</a> of [<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span> through the Broker, as shown by the interaction O in <a href="#archi" class="auto internal xref">Figure 1</a>. That is, an anonymous Client can discover:<a href="#section-2-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-13.1">
          <p id="section-2-13.1.1">the Broker itself, by relying on the resource type "core.ps" (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-16#section-2.3.1" class="relref">Section 2.3.1</a> of [<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>); and<a href="#section-2-13.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-13.2">
          <p id="section-2-13.2.1">topics of interest at the Broker (i.e., the corresponding topic resources hosted at the Broker), by relying on the resource type "core.ps.conf" (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-16#section-2.3.3" class="relref">Section 2.3.3</a> of [<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>).<a href="#section-2-13.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-14">However, an anonymous Client is not allowed to access topic resources at the Broker and obtain from those any additional information or metadata about the corresponding topic (e.g., the topic status, the URI of the topic-data resource where to publish or subscribe for that topic, or the URI to the KDC).<a href="#section-2-14" class="pilcrow">¶</a></p>
<p id="section-2-15">As highlighted in <a href="#associations" class="auto internal xref">Figure 2</a>, each Client maintains two different security associations pertaining to the Pub-Sub group communication. On the one hand, the Client has a pairwise security association with the Broker, which, as an ACE RS, verifies that the Client is authorised to perform data operations (i.e., publish, subscribe, read, delete) on a certain set of topics (Security Association 1). As discussed above, this security association is set up with the help of the AS and using a transport profile of ACE, when the Client obtains the access token to upload to the Broker.<a href="#section-2-15" class="pilcrow">¶</a></p>
<p id="section-2-16">On the other hand, separately for each topic, all the Publishers and Subscribers for that topic have a common, group security association, through which the published content sent through the Broker is protected end-to-end (Security Association 2). As discussed above, this security association is set up and maintained as the different Clients request the KDC to join the security group, upon which they obtain from the KDC the corresponding group keying material to use for protecting end-to-end and verifying the content of their Pub-Sub group communication.<a href="#section-2-16" class="pilcrow">¶</a></p>
<span id="name-security-associations-betwe"></span><div id="associations">
<figure id="figure-2">
        <div id="section-2-17.1">
          <div class="alignCenter art-svg artwork" id="section-2-17.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="240" width="544" viewBox="0 0 544 240" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,112" fill="none" stroke="black"></path>
              <path d="M 40,120 L 40,208" fill="none" stroke="black"></path>
              <path d="M 72,120 L 72,160" fill="none" stroke="black"></path>
              <path d="M 104,32 L 104,112" fill="none" stroke="black"></path>
              <path d="M 216,32 L 216,112" fill="none" stroke="black"></path>
              <path d="M 248,120 L 248,160" fill="none" stroke="black"></path>
              <path d="M 288,120 L 288,160" fill="none" stroke="black"></path>
              <path d="M 320,32 L 320,112" fill="none" stroke="black"></path>
              <path d="M 432,32 L 432,112" fill="none" stroke="black"></path>
              <path d="M 464,120 L 464,160" fill="none" stroke="black"></path>
              <path d="M 504,120 L 504,208" fill="none" stroke="black"></path>
              <path d="M 536,32 L 536,112" fill="none" stroke="black"></path>
              <path d="M 8,32 L 104,32" fill="none" stroke="black"></path>
              <path d="M 216,32 L 320,32" fill="none" stroke="black"></path>
              <path d="M 432,32 L 536,32" fill="none" stroke="black"></path>
              <path d="M 8,112 L 104,112" fill="none" stroke="black"></path>
              <path d="M 216,112 L 320,112" fill="none" stroke="black"></path>
              <path d="M 432,112 L 536,112" fill="none" stroke="black"></path>
              <path d="M 72,160 L 112,160" fill="none" stroke="black"></path>
              <path d="M 200,160 L 248,160" fill="none" stroke="black"></path>
              <path d="M 288,160 L 336,160" fill="none" stroke="black"></path>
              <path d="M 424,160 L 464,160" fill="none" stroke="black"></path>
              <path d="M 40,208 L 224,208" fill="none" stroke="black"></path>
              <path d="M 312,208 L 504,208" fill="none" stroke="black"></path>
              <g class="text">
                <text x="56" y="68">Publisher</text>
                <text x="268" y="68">Broker</text>
                <text x="484" y="68">Subscriber</text>
                <text x="156" y="164">Security</text>
                <text x="380" y="164">Security</text>
                <text x="152" y="180">Association</text>
                <text x="208" y="180">1</text>
                <text x="376" y="180">Association</text>
                <text x="432" y="180">1</text>
                <text x="268" y="212">Security</text>
                <text x="264" y="228">Association</text>
                <text x="320" y="228">2</text>
              </g>
            </svg><a href="#section-2-17.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-security-associations-betwe" class="selfRef">Security Associations between Publisher, Broker, and Subscriber</a>
        </figcaption></figure>
</div>
<p id="section-2-18">In summary, this profile specifies the following functionalities.<a href="#section-2-18" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2-19">
<li id="section-2-19.1">
          <p id="section-2-19.1.1">A Client obtains the authorization to participate in a Pub-Sub topic at the Broker with certain permissions. This pertains operations defined in <span>[<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span> for taking part in Pub-Sub communication with CoAP.<a href="#section-2-19.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-2-19.2">
          <p id="section-2-19.2.1">A Client obtains the authorization to join a security group with certain permissions. This allows the Client to obtain from the KDC the group keying material for communicating with other group members, i.e., to protect end-to-end and verify the content published at the Broker on topics associated with the security group.<a href="#section-2-19.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-2-19.3">
          <p id="section-2-19.3.1">A Client obtains from the KDC the authentication credentials of other group members, and provides or updates the KDC with its own authentication credential.<a href="#section-2-19.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-2-19.4">
          <p id="section-2-19.4.1">A Client leaves the group or is removed from the group by the KDC.<a href="#section-2-19.4.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-2-19.5">
          <p id="section-2-19.5.1">The KDC renews and redistributes the group keying material (rekeying), e.g., due to a membership change in the group.<a href="#section-2-19.5.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-2-20"><a href="#groupcomm_requirements" class="auto internal xref">Appendix A</a> lists the specifications on this application profile of ACE, based on the requirements defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#appendix-A" class="relref">Appendix A</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-2-20" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorisation">
<section id="section-3">
      <h2 id="name-getting-authorisation-to-jo">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-getting-authorisation-to-jo" class="section-name selfRef">Getting Authorisation to Join a Pub-Sub security group (A)</a>
      </h2>
<p id="section-3-1"><a href="#message-flow" class="auto internal xref">Figure 3</a> provides a high level overview of the message flow for a Client getting authorisation to join a group. Square brackets denote optional steps. The message flow is expanded in the subsequent sections.<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-authorisation-flow"></span><div id="message-flow">
<figure id="figure-3">
        <div id="section-3-2.1">
          <div class="alignCenter art-svg artwork" id="section-3-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="576" width="576" viewBox="0 0 576 576" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 16,48 L 16,560" fill="none" stroke="black"></path>
              <path d="M 456,48 L 456,152" fill="none" stroke="black"></path>
              <path d="M 456,184 L 456,328" fill="none" stroke="black"></path>
              <path d="M 456,360 L 456,392" fill="none" stroke="black"></path>
              <path d="M 456,424 L 456,448" fill="none" stroke="black"></path>
              <path d="M 456,488 L 456,560" fill="none" stroke="black"></path>
              <path d="M 520,48 L 520,392" fill="none" stroke="black"></path>
              <path d="M 520,424 L 520,456" fill="none" stroke="black"></path>
              <path d="M 520,488 L 520,560" fill="none" stroke="black"></path>
              <path d="M 560,48 L 560,560" fill="none" stroke="black"></path>
              <path d="M 32,64 L 112,64" fill="none" stroke="black"></path>
              <path d="M 352,64 L 440,64" fill="none" stroke="black"></path>
              <path d="M 32,96 L 160,96" fill="none" stroke="black"></path>
              <path d="M 312,96 L 440,96" fill="none" stroke="black"></path>
              <path d="M 32,112 L 168,112" fill="none" stroke="black"></path>
              <path d="M 304,112 L 440,112" fill="none" stroke="black"></path>
              <path d="M 16,160 L 72,160" fill="none" stroke="black"></path>
              <path d="M 416,160 L 512,160" fill="none" stroke="black"></path>
              <path d="M 24,176 L 72,176" fill="none" stroke="black"></path>
              <path d="M 424,176 L 520,176" fill="none" stroke="black"></path>
              <path d="M 16,224 L 80,224" fill="none" stroke="black"></path>
              <path d="M 384,224 L 448,224" fill="none" stroke="black"></path>
              <path d="M 24,240 L 80,240" fill="none" stroke="black"></path>
              <path d="M 384,240 L 448,240" fill="none" stroke="black"></path>
              <path d="M 32,288 L 48,288" fill="none" stroke="black"></path>
              <path d="M 416,288 L 440,288" fill="none" stroke="black"></path>
              <path d="M 16,336 L 88,336" fill="none" stroke="black"></path>
              <path d="M 408,336 L 512,336" fill="none" stroke="black"></path>
              <path d="M 24,352 L 88,352" fill="none" stroke="black"></path>
              <path d="M 416,352 L 520,352" fill="none" stroke="black"></path>
              <path d="M 16,400 L 104,400" fill="none" stroke="black"></path>
              <path d="M 408,400 L 552,400" fill="none" stroke="black"></path>
              <path d="M 24,416 L 104,416" fill="none" stroke="black"></path>
              <path d="M 408,416 L 552,416" fill="none" stroke="black"></path>
              <path d="M 16,464 L 72,464" fill="none" stroke="black"></path>
              <path d="M 480,464 L 552,464" fill="none" stroke="black"></path>
              <path d="M 24,480 L 104,480" fill="none" stroke="black"></path>
              <path d="M 432,480 L 560,480" fill="none" stroke="black"></path>
              <path d="M 16,528 L 152,528" fill="none" stroke="black"></path>
              <path d="M 304,528 L 448,528" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="560,464 548,458.4 548,469.6" fill="black" transform="rotate(0,552,464)"></polygon>
              <polygon class="arrowhead" points="560,416 548,410.4 548,421.6" fill="black" transform="rotate(0,552,416)"></polygon>
              <polygon class="arrowhead" points="560,400 548,394.4 548,405.6" fill="black" transform="rotate(0,552,400)"></polygon>
              <polygon class="arrowhead" points="520,336 508,330.4 508,341.6" fill="black" transform="rotate(0,512,336)"></polygon>
              <polygon class="arrowhead" points="520,160 508,154.4 508,165.6" fill="black" transform="rotate(0,512,160)"></polygon>
              <polygon class="arrowhead" points="456,528 444,522.4 444,533.6" fill="black" transform="rotate(0,448,528)"></polygon>
              <polygon class="arrowhead" points="456,240 444,234.4 444,245.6" fill="black" transform="rotate(0,448,240)"></polygon>
              <polygon class="arrowhead" points="456,224 444,218.4 444,229.6" fill="black" transform="rotate(0,448,224)"></polygon>
              <polygon class="arrowhead" points="448,288 436,282.4 436,293.6" fill="black" transform="rotate(0,440,288)"></polygon>
              <polygon class="arrowhead" points="448,96 436,90.4 436,101.6" fill="black" transform="rotate(0,440,96)"></polygon>
              <polygon class="arrowhead" points="448,64 436,58.4 436,69.6" fill="black" transform="rotate(0,440,64)"></polygon>
              <polygon class="arrowhead" points="40,288 28,282.4 28,293.6" fill="black" transform="rotate(180,32,288)"></polygon>
              <polygon class="arrowhead" points="40,112 28,106.4 28,117.6" fill="black" transform="rotate(180,32,112)"></polygon>
              <polygon class="arrowhead" points="40,64 28,58.4 28,69.6" fill="black" transform="rotate(180,32,64)"></polygon>
              <polygon class="arrowhead" points="32,480 20,474.4 20,485.6" fill="black" transform="rotate(180,24,480)"></polygon>
              <polygon class="arrowhead" points="32,416 20,410.4 20,421.6" fill="black" transform="rotate(180,24,416)"></polygon>
              <polygon class="arrowhead" points="32,352 20,346.4 20,357.6" fill="black" transform="rotate(180,24,352)"></polygon>
              <polygon class="arrowhead" points="32,240 20,234.4 20,245.6" fill="black" transform="rotate(180,24,240)"></polygon>
              <polygon class="arrowhead" points="32,176 20,170.4 20,181.6" fill="black" transform="rotate(180,24,176)"></polygon>
              <g class="text">
                <text x="28" y="36">Client</text>
                <text x="460" y="36">Broker</text>
                <text x="524" y="36">AS</text>
                <text x="560" y="36">KDC</text>
                <text x="24" y="68">[</text>
                <text x="160" y="68">Discovery</text>
                <text x="212" y="68">of</text>
                <text x="248" y="68">Topic</text>
                <text x="308" y="68">Resource</text>
                <text x="448" y="68">]</text>
                <text x="24" y="100">[</text>
                <text x="204" y="100">Resource</text>
                <text x="272" y="100">Request</text>
                <text x="448" y="100">]</text>
                <text x="24" y="116">[</text>
                <text x="188" y="116">AS</text>
                <text x="248" y="116">Information</text>
                <text x="448" y="116">]</text>
                <text x="136" y="164">Authorisation</text>
                <text x="224" y="164">Request</text>
                <text x="300" y="164">(Audience:</text>
                <text x="376" y="164">Broker)</text>
                <text x="136" y="180">Authorisation</text>
                <text x="228" y="180">Response</text>
                <text x="308" y="180">(Audience:</text>
                <text x="384" y="180">Broker)</text>
                <text x="116" y="228">Upload</text>
                <text x="156" y="228">of</text>
                <text x="224" y="228">authorisation</text>
                <text x="328" y="228">information</text>
                <text x="144" y="244">Establishment</text>
                <text x="212" y="244">of</text>
                <text x="252" y="244">secure</text>
                <text x="328" y="244">association</text>
                <text x="24" y="292">[</text>
                <text x="96" y="292">Discovery</text>
                <text x="148" y="292">of</text>
                <text x="176" y="292">KDC</text>
                <text x="208" y="292">and</text>
                <text x="244" y="292">name</text>
                <text x="276" y="292">of</text>
                <text x="324" y="292">security</text>
                <text x="384" y="292">group</text>
                <text x="448" y="292">]</text>
                <text x="152" y="340">Authorisation</text>
                <text x="240" y="340">Request</text>
                <text x="316" y="340">(Audience:</text>
                <text x="380" y="340">KDC)</text>
                <text x="152" y="356">Authorisation</text>
                <text x="244" y="356">Response</text>
                <text x="324" y="356">(Audience:</text>
                <text x="388" y="356">KDC)</text>
                <text x="140" y="404">Upload</text>
                <text x="180" y="404">of</text>
                <text x="248" y="404">authorisation</text>
                <text x="352" y="404">information</text>
                <text x="168" y="420">Establishment</text>
                <text x="236" y="420">of</text>
                <text x="276" y="420">secure</text>
                <text x="352" y="420">association</text>
                <text x="112" y="468">Request</text>
                <text x="156" y="468">to</text>
                <text x="188" y="468">join</text>
                <text x="224" y="468">the</text>
                <text x="276" y="468">security</text>
                <text x="336" y="468">group</text>
                <text x="376" y="468">for</text>
                <text x="408" y="468">the</text>
                <text x="448" y="468">topic</text>
                <text x="140" y="484">Keying</text>
                <text x="204" y="484">material</text>
                <text x="256" y="484">for</text>
                <text x="288" y="484">the</text>
                <text x="340" y="484">security</text>
                <text x="400" y="484">group</text>
                <text x="196" y="532">Resource</text>
                <text x="264" y="532">Request</text>
                <text x="176" y="548">(Publication/Subscription</text>
                <text x="292" y="548">to</text>
                <text x="320" y="548">the</text>
                <text x="364" y="548">topic)</text>
              </g>
            </svg><a href="#section-3-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-authorisation-flow" class="selfRef">Authorisation Flow</a>
        </figcaption></figure>
</div>
<p id="section-3-3">After a Client uploads to the Broker the authorisation information for participating in a Pub-Sub topic with name TOPICNAME (see <a href="#auth-request" class="auto internal xref">Section 3.4</a>), the Client can perform the optional discovery of the KDC and security group name at the Broker, by accessing the topic resource corresponding to the topic in question (see <a href="#kdc-discovery" class="auto internal xref">Section 3.3</a>).<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">In order to ensure that the Client can seamlessly access the right topic resource at the Broker, it is <span class="bcp14">RECOMMENDED</span> that a Broker implementing this application profile uses the path /ps/TOPICNAME to host the topic resource for the topic with name TOPICNAME.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">Alternatively, the Client might not know the right topic resource to target, and thus would attempt to access different ones (e.g., based on the result of an early discovery of topic resources, see <a href="#topic-discovery" class="auto internal xref">Section 3.1</a>), until it finds the right one specifying TOPICNAME as value of the 'topic-name' parameter in the resource representation.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">Since <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> recommends the use of CoAP and CBOR, this document describes the exchanges assuming that CoAP and CBOR are used.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">However, using HTTP instead of CoAP is possible, by leveraging the corresponding parameters and methods. Analogously, JSON <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> can be used instead of CBOR, by relying on the conversion method specified in Sections <a href="https://rfc-editor.org/rfc/rfc8949#section-6.1" class="relref">6.1</a> and <a href="https://rfc-editor.org/rfc/rfc8949#section-6.2" class="relref">6.2</a> of <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>. In case JSON is used, the Content-Format of the message has to be specified accordingly. Exact definitions of these exchanges are out of scope for this document.<a href="#section-3-7" class="pilcrow">¶</a></p>
<div id="topic-discovery">
<section id="section-3.1">
        <h3 id="name-topic-discovery-at-the-brok">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-topic-discovery-at-the-brok" class="section-name selfRef">Topic Discovery at the Broker (Optional)</a>
        </h3>
<p id="section-3.1-1">The discovery of a topic at the Broker can be performed by discovering the corresponding topic resource hosted at the Broker. For example, the Client can send a lookup request to /.well-known/core at the Broker, specifying as lookup criterion the resource type "core.ps.conf" (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-16#section-2.3.3" class="relref">Section 2.3.3</a> of [<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>).<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Although the links to the topic resources are also specified in the representation of the collection resource at the Broker (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-16#section-2.4" class="relref">Section 2.4</a> of [<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>), the Client is not supposed to access such a resource, as intended for administrative operations that are out of the scope of this document.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AS-discovery">
<section id="section-3.2">
        <h3 id="name-as-discovery-at-the-broker-">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-as-discovery-at-the-broker-" class="section-name selfRef">AS Discovery at the Broker (Optional)</a>
        </h3>
<p id="section-3.2-1">Complementary to what is defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> for AS discovery, the Broker <span class="bcp14">MAY</span> send the address of the AS to the Client in the 'AS' parameter of the AS Request Creation Hints, as a response to an Unauthorised Resource Request (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>). An example using the CBOR diagnostic notation and CoAP is given below.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span id="name-as-request-creation-hints-e"></span><div id="AS-info-ex">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-3.2-2.1">
<pre>
    4.01 Unauthorized
    Content-Format: application/ace+cbor
    Payload:
    {
     / AS / 1 : "coaps://as.example.com/token"
    }
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-as-request-creation-hints-e" class="selfRef">AS Request Creation Hints Example</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="kdc-discovery">
<section id="section-3.3">
        <h3 id="name-kdc-discovery-at-the-broker">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-kdc-discovery-at-the-broker" class="section-name selfRef">KDC Discovery at the Broker (Optional)</a>
        </h3>
<p id="section-3.3-1">Once a Client has obtained an access token from the AS and accordingly established a secure association with the Broker, the Client has the permission to access the topic resources at the Broker that pertain to the topics on which the Client is authorised to operate.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">In particular the Client is authorised to retrieve the representation of a topic resource, from which the Client can retrieve information related to the topic in question, as specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-16#section-2.5" class="relref">Section 2.5</a> of [<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">This profile extends the set of CoAP Pub-Sub Parameters that is possible to specify within the representation of a topic resource, as originally defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-16#section-3" class="relref">Section 3</a> of [<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>. In particular, this profile defines the following two parameters that the Broker can specify in a response from a topic resource (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-16#section-2.5" class="relref">Section 2.5</a> of [<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>). Note that, when these parameters are transported in their respective fields of the message payload, the Content-Format application/core-pubsub+cbor defined in <span>[<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span> <span class="bcp14">MUST</span> be used.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-4.1">
            <p id="section-3.3-4.1.1">'kdc_uri', with value the URI of the group membership resource at the KDC, where Clients can send a request to join the security group associated with the topic in question. The URI is encoded as a CBOR text string. Clients will have to obtain an access token from the AS to upload to the KDC, before starting the process to join the security group at the KDC.<a href="#section-3.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-4.2">
            <p id="section-3.3-4.2.1">'sec_gp', specifying the name of the security group associated with the topic in question, as a stable and invariant identifier. The name of the security group is encoded as a CBOR text string.<a href="#section-3.3-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-5">Furthermore, the Resource Type (rt=) Link Target Attribute value "core.ps.gm" is registered in <a href="#core_rt" class="auto internal xref">Section 9.3</a> (REQ10), and can be used to describe group-membership resources at the KDC, e.g., by using a link-format document <span>[<a href="#RFC6690" class="cite xref">RFC6690</a>]</span>. As an alternative to the discovery approach defined above and provided by the Broker, applications can use this common resource type to discover links to group-membership resources at the KDC for joining security groups associated with Pub-Sub topics.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="auth-request">
<section id="section-3.4">
        <h3 id="name-authorisation-request-respo">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-authorisation-request-respo" class="section-name selfRef">Authorisation Request/Response for the KDC and the Broker</a>
        </h3>
<p id="section-3.4-1">A Client sends two Authorisation Requests to the AS, targeting two different audiences, i.e., the Broker and the KDC.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">As to the former, the AS handles Authorisation Requests related to a topic for which the Client is allowed to perform topic data operations at the Broker, as corresponding to an application group.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">As to the latter, the AS handles Authorization Requests for security groups that the Client is allowed to join, in order to obtain the group keying material for protecting end-to-end and verifying the content of exchanged messages on the associated Pub-Sub topics.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">This section builds on <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3" class="relref">Section 3</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> and defines only additions or modifications to that specification.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">Both Authorisation Requests include the following fields (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>):<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-6.1">
            <p id="section-3.4-6.1.1">'scope': Optional. If present, it specifies the following information, depending on the specifically targeted audience.<a href="#section-3.4-6.1.1" class="pilcrow">¶</a></p>
<p id="section-3.4-6.1.2">
If the audience is the Broker, the scope specifies the name of the topics that the Client wishes to access, together with the corresponding requested permissions.<a href="#section-3.4-6.1.2" class="pilcrow">¶</a></p>
<p id="section-3.4-6.1.3">
If the audience is the KDC, the scope specifies the name of the security groups that the Client wishes to join, together with the corresponding requested permissions.<a href="#section-3.4-6.1.3" class="pilcrow">¶</a></p>
<p id="section-3.4-6.1.4">
This parameter is encoded as a CBOR byte string, whose value is the binary encoding of a CBOR array. The format of the encoded scope <span class="bcp14">MUST</span> follow the data model AIF-PUBSUB-GROUPCOMM defined in <a href="#scope" class="auto internal xref">Section 3.4.1</a>.<a href="#section-3.4-6.1.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.2">
            <p id="section-3.4-6.2.1">'audience': Required identifier corresponding to either the Broker or the KDC.<a href="#section-3.4-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-7">Other additional parameters can be included if necessary, as defined in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<p id="section-3.4-8">When using this profile, it is expected that a one-to-one mapping is enforced between the application group and the security group (see <a href="#overview" class="auto internal xref">Section 2</a>). If this is not the case, the correct access policies for both sets of scopes have to be available to the AS.<a href="#section-3.4-8" class="pilcrow">¶</a></p>
<div id="scope">
<section id="section-3.4.1">
          <h4 id="name-format-of-scope">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-format-of-scope" class="section-name selfRef">Format of Scope</a>
          </h4>
<p id="section-3.4.1-1">Building on <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, this section defines the exact format and encoding of scope used in this profile.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2">To this end, this profile uses the Authorization Information Format (AIF) <span>[<a href="#RFC9237" class="cite xref">RFC9237</a>]</span> (REQ1). With reference to the generic AIF model<a href="#section-3.4.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.1-3">
<pre>
      AIF-Generic&lt;Toid, Tperm&gt; = [* [Toid, Tperm]]
</pre><a href="#section-3.4.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.4.1-4">the value of the CBOR byte string used as scope encodes the CBOR array [* [Toid, Tperm]], where each [Toid, Tperm] element corresponds to one scope entry.<a href="#section-3.4.1-4" class="pilcrow">¶</a></p>
<p id="section-3.4.1-5">Furthermore, this document defines the new AIF data model AIF-PUBSUB-GROUPCOMM that this profile <span class="bcp14">MUST</span> use to format and encode scope entries.<a href="#section-3.4.1-5" class="pilcrow">¶</a></p>
<p id="section-3.4.1-6">In particular, the following holds for each scope entry.<a href="#section-3.4.1-6" class="pilcrow">¶</a></p>
<p id="section-3.4.1-7">The object identifier ("Toid") is specialized as a CBOR item specifying the name of the group pertaining to the scope entry.<a href="#section-3.4.1-7" class="pilcrow">¶</a></p>
<p id="section-3.4.1-8">The permission set ("Tperm") is specialized as a CBOR unsigned integer with value R, specifying the permissions that the Client wishes to have in the group indicated by "Toid".<a href="#section-3.4.1-8" class="pilcrow">¶</a></p>
<p id="section-3.4.1-9">More specifically, the following applies when, as defined in this document, a scope entry includes a set of permissions for user-related operations performed by a pubsub Client.<a href="#section-3.4.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.1-10.1">
              <p id="section-3.4.1-10.1.1">The object identifier ("Toid") is a CBOR text string, specifying the name of one application group (topic) or of the corresponding security group to which the scope entry pertains.<a href="#section-3.4.1-10.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.4.1-10.2">
              <p id="section-3.4.1-10.2.1">The permission set ("Tperm") is a CBOR unsigned integer, whose value R specifies the operations that the Client wishes to or has been authorised to perform on the resources at the Broker associated with the application group (topic) indicated by "Toid", or on the resources at the KDC associated with the security group indicated by "Toid" (REQ1). The value R is computed as follows.<a href="#section-3.4.1-10.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.1-10.2.2.1">
                  <p id="section-3.4.1-10.2.2.1.1">Each operation (i.e., permission detail) in the permission set is converted into the corresponding numeric identifier X taken from the following set.<a href="#section-3.4.1-10.2.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.1-10.2.2.1.2.1">
                      <p id="section-3.4.1-10.2.2.1.2.1.1">Admin (0): This operation is reserved for scope entries that express permissions for Administrators of Pub-Sub groups, which are not specified in this document.<a href="#section-3.4.1-10.2.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-3.4.1-10.2.2.1.2.2">
                      <p id="section-3.4.1-10.2.2.1.2.2.1">AppGroup (1): This operation is signaled as wished/authorised when "Toid" specifies the name of an application group (topic), while it is signaled as not wished/authorised when Toid specifies the name of a security group.<a href="#section-3.4.1-10.2.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-3.4.1-10.2.2.1.2.3">
                      <p id="section-3.4.1-10.2.2.1.2.3.1">Publish (2): This operation concerns the publication of data to the topic in question, performed by means of a PUT request sent by a Publisher Client to the corresponding topic-data resource at the Broker.<a href="#section-3.4.1-10.2.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-3.4.1-10.2.2.1.2.4">
                      <p id="section-3.4.1-10.2.2.1.2.4.1">Read (3): This operation concerns both: i) the subscription at the topic-data resource for the topic in question at the Broker, performed by means of a GET request with the CoAP Observe Option set to 0 and sent by a Subscriber Client; and ii) the simple reading of the latest data published to the topic in question, performed by means of a simple GET request sent to the same topic-data resource.<a href="#section-3.4.1-10.2.2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-3.4.1-10.2.2.1.2.5">
                      <p id="section-3.4.1-10.2.2.1.2.5.1">Delete (4): This operation concerns the deletion of the topic-data resource for the topic in question at the Broker, performed by means of a DELETE request sent to that resource.<a href="#section-3.4.1-10.2.2.1.2.5.1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-10.2.2.1.2.5.2">
If a Client wishes to have authorised only the Delete operation on an application group, then the Client does not need to join the corresponding security group, hence it does not need to request an access token for interacting with the KDC.<a href="#section-3.4.1-10.2.2.1.2.5.2" class="pilcrow">¶</a></p>
<p id="section-3.4.1-10.2.2.1.2.5.3">
If a Client wishes to have authorised the Delete operation on a security group, then the AS and the KDC ignore the wish for that operation when processing the scope entry in question.<a href="#section-3.4.1-10.2.2.1.2.5.3" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal" id="section-3.4.1-10.2.2.2">
                  <p id="section-3.4.1-10.2.2.2.1">The set of N numeric identifiers is converted into the single value R, by taking two to the power of each numeric identifier X_1, X_2, ..., X_N, and then computing the inclusive OR of the binary representations of all the power values.<a href="#section-3.4.1-10.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-3.4.1-10.2.3">
Since this application profile considers user-related operations, the "Admin" operation is signaled as not wished/authorised. That is, the scope entries <span class="bcp14">MUST</span> have the least significant bit of "Tperm" set to 0.<a href="#section-3.4.1-10.2.3" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.4.1-11">If the "Toid" of a scope entry in an access token specifies the name of an application group (i.e., the "AppGroup" operation is signaled as authorised), the Client has also the permission to retrieve the configuration of the application group (topic) whose name is indicated by "Toid", by sending a GET or FETCH request to the corresponding topic resource at the Broker.<a href="#section-3.4.1-11" class="pilcrow">¶</a></p>
<p id="section-3.4.1-12">The specific interactions between the Client and the Broker are defined in <span>[<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>.<a href="#section-3.4.1-12" class="pilcrow">¶</a></p>
<p id="section-3.4.1-13">The following CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> notation defines a scope entry that uses the AIF-PUBSUB-GROUPCOMM data model and expresses a set of permissions.<a href="#section-3.4.1-13" class="pilcrow">¶</a></p>
<span id="name-pub-sub-scope-using-the-aif"></span><div id="scope-aif">
<figure id="figure-5">
            <div class="alignCenter art-text artwork" id="section-3.4.1-14.1">
<pre>
  AIF-PUBSUB-GROUPCOMM = AIF-Generic&lt;pubsub-group, pubsub-perm&gt;
   pubsub-group = tstr ; name of Pub-Sub topic or of
                       ; the associated security group

   pubsub-perm = uint .bits pubsub-perm-details

   pubsub-perm-details = &amp;(
    Admin: 0,
    AppGroup: 1,
    Publish: 2,
    Read: 3,
    Delete: 4
   )

   scope_entry = [pubsub-group, pubsub-perm]
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-pub-sub-scope-using-the-aif" class="selfRef">Pub-Sub scope using the AIF format</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="as-response">
<section id="section-3.5">
        <h3 id="name-authorization-response">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-authorization-response" class="section-name selfRef">Authorization response</a>
        </h3>
<p id="section-3.5-1">The AS responds with an Authorization Response as defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the following additions:<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-2.1">
            <p id="section-3.5-2.1.1">In the Authorization Response, the AS <span class="bcp14">MUST</span> include the 'expires_in' parameter.  Other means for the AS to specify the lifetime of access tokens are out of the scope of this document.<a href="#section-3.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-2.2">
            <p id="section-3.5-2.2.1">In the Authorization Response, the AS <span class="bcp14">MUST</span> include the 'scope' parameter, when the value included in the access token differs from the one specified by the Client in the Authorization Request.  In such a case, the second element of each scope entry specifies the set of operations that the Client is authorised for that scope entry, encoded as specified in <a href="#auth-request" class="auto internal xref">Section 3.4</a>.<a href="#section-3.5-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.5-3">Furthermore, the AS <span class="bcp14">MAY</span> use the extended format of scope defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-7" class="relref">Section 7</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> for the 'scope' claim of the access token. In such a case, the AS <span class="bcp14">MUST</span> use the CBOR tag with tag number TAG_NUMBER, associated with the CoAP Content-Format CF_ID for the media type application/aif+cbor registered in <a href="#content_formats" class="auto internal xref">Section 9.5</a> of this document (REQ28).<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4">Note to RFC Editor: In the previous paragraph, please replace "TAG_NUMBER" with the CBOR tag number computed as TN(ct) in <span><a href="https://rfc-editor.org/rfc/rfc9277#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC9277" class="cite xref">RFC9277</a>]</span>, where ct is the ID assigned to the CoAP Content-Format registered in <a href="#content_formats" class="auto internal xref">Section 9.5</a> of this document.  Then, please replace "CF_ID" with the ID assigned to that CoAP Content-Format.  Finally, please delete this paragraph.<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<p id="section-3.5-5">This indicates that the binary encoded scope follows the scope semantics defined for this application profile in <a href="#scope" class="auto internal xref">Section 3.4.1</a> of this document.<a href="#section-3.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-post">
<section id="section-3.6">
        <h3 id="name-token-transfer-to-the-kdc">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-token-transfer-to-the-kdc" class="section-name selfRef">Token Transfer to the KDC</a>
        </h3>
<p id="section-3.6-1">The Client transfers its access token to the KDC using one of the methods defined in the <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. This typically includes sending a POST request to the /authz-info endpoint. However, if the DTLS transport profile of ACE <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span> is used and the Client uses a symmetric proof-of-possession key in the DTLS handshake, the Client <span class="bcp14">MAY</span> provide the access token to the KDC in the "psk_identity" field of the DTLS ClientKeyExchange message when using DTLS 1.2 <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span>, or in the "identity" field of a PskIdentity within the PreSharedKeyExtension of the ClientHello message when using DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>. In addition to that, the following applies.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2">In the Token Transfer Response to the Publishers, i.e., the Clients whose scope of the access token includes the "Publish" permission for at least one scope entry, the KDC <span class="bcp14">MUST</span> include the parameter 'kdcchallenge' in the CBOR map. 'kdcchallenge' is a challenge N_S generated by the KDC, and is <span class="bcp14">RECOMMENDED</span> to be an 8-byte long random nonce. Later when joining the group, the Publisher can use the 'kdcchallenge' as part of proving possession of its private key (see <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>). If a Publisher provides the access token to the KDC through an /authz-info endpoint, the Client <span class="bcp14">MUST</span> support the parameter 'kdcchallenge'.<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<p id="section-3.6-3">If 'sign_info' is included in the Token Transfer Request, the KDC <span class="bcp14">SHOULD</span> include the 'sign_info' parameter in the Token Transfer Response. Note that the joining node may have obtained such information by alternative means, e.g., the 'sign_info' may have been pre-configured (OPT3).<a href="#section-3.6-3" class="pilcrow">¶</a></p>
<p id="section-3.6-4">The following applies for each element 'sign_info_entry'.<a href="#section-3.6-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-5.1">
            <p id="section-3.6-5.1.1">'sign_alg' <span class="bcp14">MUST</span> take its value from the "Value" column of one of the recommended algorithms in the "COSE Algorithms" registry <span>[<a href="#IANA.cose_algorithms" class="cite xref">IANA.cose_algorithms</a>]</span> (REQ3).<a href="#section-3.6-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.6-5.2">
            <p id="section-3.6-5.2.1">'sign_parameters' is a CBOR array.  Its format and value are the same of the COSE capabilities array for the algorithm indicated in 'sign_alg' under the "Capabilities" column of the "COSE Algorithms" registry <span>[<a href="#IANA.cose_algorithms" class="cite xref">IANA.cose_algorithms</a>]</span> (REQ4).<a href="#section-3.6-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.6-5.3">
            <p id="section-3.6-5.3.1">'sign_key_parameters' is a CBOR array.  Its format and value are the same of the COSE capabilities array for the COSE key type of the keys used with the algorithm indicated in 'sign_alg', as specified for that key type in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#IANA.cose_key-type" class="cite xref">IANA.cose_key-type</a>]</span> (REQ5).<a href="#section-3.6-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.6-5.4">
            <p id="section-3.6-5.4.1">'cred_fmt' takes value from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#IANA.cose_header-parameters" class="cite xref">IANA.cose_header-parameters</a>]</span> (REQ6). Acceptable values denote a format of authentication credential that <span class="bcp14">MUST</span> explicitly provide the public key as well as the comprehensive set of information related to the public key algorithm, including, e.g., the used elliptic curve (when applicable).<a href="#section-3.6-5.4.1" class="pilcrow">¶</a></p>
<p id="section-3.6-5.4.2">
Acceptable formats of authentication credentials include CBOR Web Tokens (CWTs) and CWT Claims Sets (CCSs) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, X.509 certificates <span>[<a href="#RFC7925" class="cite xref">RFC7925</a>]</span>, and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. Future formats would be acceptable to use as long as they comply with the criteria defined above.<a href="#section-3.6-5.4.2" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="kdc-interface">
<section id="section-4">
      <h2 id="name-client-group-communication-">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-client-group-communication-" class="section-name selfRef">Client Group Communication Interface at the KDC</a>
      </h2>
<p id="section-4-1">In order to enable secure group communication for the Pub-Sub Clients, the KDC provides the resources listed in <a href="#tab-kdc-resources" class="auto internal xref">Table 1</a>. Each resource is marked as <span class="bcp14">REQUIRED</span> or <span class="bcp14">OPTIONAL</span> to be hosted at the KDC.<a href="#section-4-1" class="pilcrow">¶</a></p>
<span id="name-resources-at-the-kdc"></span><div id="tab-kdc-resources">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-resources-at-the-kdc" class="selfRef">Resources at the KDC</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">KDC resource</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
            <th class="text-left" rowspan="1" colspan="1">Operations</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">/ace-group</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span class="bcp14">REQUIRED</span>. Contains a set of group names, each corresponding to one of the specified group identifiers.</td>
            <td class="text-left" rowspan="1" colspan="1">FETCH (All Clients)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span class="bcp14">REQUIRED</span>. Contains symmetric group keying material associated with GROUPNAME.</td>
            <td class="text-left" rowspan="1" colspan="1">GET, POST (All Clients)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME/creds</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span class="bcp14">REQUIRED</span>. Contains the authentication credentials of all the Publishers of the group with name GROUPNAME.</td>
            <td class="text-left" rowspan="1" colspan="1">GET, FETCH (All Clients)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME/num</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span class="bcp14">REQUIRED</span>. Contains the current version number for the symmetric group keying material of the group with name GROUPNAME.</td>
            <td class="text-left" rowspan="1" colspan="1">GET (All Clients)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME/nodes/NODENAME</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span class="bcp14">REQUIRED</span>. Contains the group keying material for that group member NODENAME in GROUPNAME.</td>
            <td class="text-left" rowspan="1" colspan="1">GET, DELETE (All Clients). POST (Publishers).</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME/nodes/NODENAME/cred</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span class="bcp14">REQUIRED</span>. Authentication credential for NODENAME in the group GROUPNAME.</td>
            <td class="text-left" rowspan="1" colspan="1">POST (Publishers)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME/kdc-cred</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span class="bcp14">REQUIRED</span> if a group re-keying mechanism is used. Contains the authentication credential of the KDC for the group with name GROUPNAME.</td>
            <td class="text-left" rowspan="1" colspan="1">GET (All Clients)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME/policies</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span class="bcp14">OPTIONAL</span>. Contains the group policies of the group with name GROUPNAME.</td>
            <td class="text-left" rowspan="1" colspan="1">GET (All Clients)</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-4-3">The use of these resources follows what is defined in <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, and only additions or modifications to that specification are defined in this document.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">Consistent with what is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, some error responses from the KDC can convey error-specific information according to the problem-details format specified in <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span>.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="join">
<section id="section-4.1">
        <h3 id="name-joining-a-security-group">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-joining-a-security-group" class="section-name selfRef">Joining a Security Group</a>
        </h3>
<p id="section-4.1-1">This section describes the interactions between a Client and the KDC to join a security group. Source authentication of a message sent within the group is ensured by means of a digital signature embedded in the message. Subscribers must be able to retrieve Publishers' authentication credentials from a trusted repository, to verify source authentication of received messages. Hence, on joining a security group, a Publisher is expected to provide its own authentication credential to the KDC.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">On a successful join, the Clients receive from the KDC the symmetric COSE Key used as shared group key to protect the payload of a published topic data.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">The message exchange between the joining node and the KDC follows what is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1.1" class="relref">Section 4.3.1.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, and only additions or modifications to that specification are defined in this document.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<span id="name-join-flow"></span><div id="join-flow">
<figure id="figure-6">
          <div id="section-4.1-4.1">
            <div class="alignCenter art-svg artwork" id="section-4.1-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="144" width="320" viewBox="0 0 320 144" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 32,48 L 32,112" fill="none" stroke="black"></path>
                <path d="M 304,48 L 304,112" fill="none" stroke="black"></path>
                <path d="M 32,64 L 72,64" fill="none" stroke="black"></path>
                <path d="M 248,64 L 296,64" fill="none" stroke="black"></path>
                <path d="M 40,96 L 72,96" fill="none" stroke="black"></path>
                <path d="M 256,96 L 304,96" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="304,64 292,58.4 292,69.6" fill="black" transform="rotate(0,296,64)"></polygon>
                <polygon class="arrowhead" points="48,96 36,90.4 36,101.6" fill="black" transform="rotate(180,40,96)"></polygon>
                <g class="text">
                  <text x="28" y="36">Client</text>
                  <text x="304" y="36">KDC</text>
                  <text x="100" y="68">Join</text>
                  <text x="152" y="68">Request</text>
                  <text x="212" y="68">(CoAP)</text>
                  <text x="100" y="100">Join</text>
                  <text x="156" y="100">Response</text>
                  <text x="220" y="100">(CoAP)</text>
                </g>
              </svg><a href="#section-4.1-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-join-flow" class="selfRef">Join Flow</a>
          </figcaption></figure>
</div>
<div id="join-request">
<section id="section-4.1.1">
          <h4 id="name-join-request">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-join-request" class="section-name selfRef">Join Request</a>
          </h4>
<p id="section-4.1.1-1">After establishing a secure communication association with the KDC, the Client sends a Join Request to the KDC as described in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. More specifically, the Client sends a POST request to the /ace-group/GROUPNAME endpoint, with Content-Format "application/ace-groupcomm+cbor". The payload contains the following information formatted as a CBOR map, which <span class="bcp14">MUST</span> be encoded as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>:<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-2.1">
              <p id="section-4.1.1-2.1.1">'scope': It <span class="bcp14">MUST</span> be present and specify the group that the Client is attempting to join, i.e., the group name, and the permissions that the Client wishes to have in the group. This value corresponds to one scope entry, as defined in <a href="#scope" class="auto internal xref">Section 3.4.1</a>.<a href="#section-4.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.1-2.2">
              <p id="section-4.1.1-2.2.1">'get_creds': It <span class="bcp14">MAY</span> be present if the Client wishes to join as a Subscriber and wants to retrieve the public keys of all the Publishers upon joining. Otherwise, this parameter <span class="bcp14">MUST NOT</span> be present. If the parameter is present, the parameter <span class="bcp14">MUST</span> encode the CBOR simple value <code>null</code> (0xf6). Note that the parameter 'role_filter' is not necessary, as the KDC returns the authentication credentials of Publishers by default.<a href="#section-4.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.1-2.3">
              <p id="section-4.1.1-2.3.1">'client_cred': The use of this parameter is detailed in <a href="#client_cred" class="auto internal xref">Section 4.1.1.1</a>.<a href="#section-4.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.1-2.4">
              <p id="section-4.1.1-2.4.1">'cnonce': It specifies a dedicated nonce N_C generated by the Client. It is <span class="bcp14">RECOMMENDED</span> to use an 8-byte long random nonce. Join Requests <span class="bcp14">MUST</span> include a new 'cnonce' at each join attempt.<a href="#section-4.1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.1-2.5">
              <p id="section-4.1.1-2.5.1">'client_cred_verify': The use of this parameter is detailed in <a href="#pop" class="auto internal xref">Section 4.1.1.2</a>.<a href="#section-4.1.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.1.1-3">As a Publisher Client has its own authentication credential to use in a group, it <span class="bcp14">MUST</span> support the client_cred', 'cnonce', and 'client_cred_verify' parameters.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<div id="client_cred">
<section id="section-4.1.1.1">
            <h5 id="name-client-credential-in-client">
<a href="#section-4.1.1.1" class="section-number selfRef">4.1.1.1. </a><a href="#name-client-credential-in-client" class="section-name selfRef">Client Credential in 'client_cred'</a>
            </h5>
<p id="section-4.1.1.1-1">One of the following cases can occur when a new Client attempts to join a security group.<a href="#section-4.1.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1.1-2.1">
                <p id="section-4.1.1.1-2.1.1">The joining node is not a Publisher, i.e., it is not going to send data to the application group.  In this case, the joining node is not required to provide its own authentication credential to the KDC. In case the joining node still provides an authentication credential in the 'client_cred' parameter of the Join Request (see <a href="#join-request" class="auto internal xref">Section 4.1.1</a>), the KDC silently ignores that parameter, as well as the related parameter 'client_cred_verify'.<a href="#section-4.1.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1.1-2.2">
                <p id="section-4.1.1.1-2.2.1">The joining node wishes to join as a Publisher, and the KDC has not previously acquired an authentication credential of the joining node. Then, the joining node <span class="bcp14">MUST</span> provide a compatible authentication credential in the 'client_cred' parameter of the Join Request (see <a href="#join-request" class="auto internal xref">Section 4.1.1</a>).<a href="#section-4.1.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1.1-2.3">
                <p id="section-4.1.1.1-2.3.1">The joining node wishes to join as a Publisher, and the KDC already acquired the authentication credential of the joining node either during a past group joining process, or when establishing a secure communication association using asymmetric proof-of-possession keys.<a href="#section-4.1.1.1-2.3.1" class="pilcrow">¶</a></p>
<p id="section-4.1.1.1-2.3.2">
If the joining node's proof-of-possession key is compatible with the signature algorithm used in the security group and with possible associated parameters, then the corresponding authentication credential can be used in the group. In this case, the joining node <span class="bcp14">MAY</span> choose not to provide again its authentication credential to the KDC in order to limit the size of the Join Request.<a href="#section-4.1.1.1-2.3.2" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.1.1.1-3">The joining node <span class="bcp14">MUST</span> provide the KDC with its own authentication credential again, if it has previously provided the KDC with multiple authentication credentials intended for different security groups.<a href="#section-4.1.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1.1-4">If the joining node provides its authentication credential, the KDC performs the consistency checks above and, in case of success, considers it as the authentication credential associated with the joining node in the group.<a href="#section-4.1.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pop">
<section id="section-4.1.1.2">
            <h5 id="name-proof-of-possession-through">
<a href="#section-4.1.1.2" class="section-number selfRef">4.1.1.2. </a><a href="#name-proof-of-possession-through" class="section-name selfRef">Proof-of-Possession through 'client_cred_verify'</a>
            </h5>
<p id="section-4.1.1.2-1">The 'client_cred_verify' parameter contains the proof-of-possession evidence, and is computed as defined below (REQ14).<a href="#section-4.1.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1.2-2">The Publisher signs the scope, concatenated with N_S and further concatenated with N_C, by using the private key corresponding to the public key that is specified in the 'client_cred' parameter.<a href="#section-4.1.1.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1.2-3">The N_S may be either of the following:<a href="#section-4.1.1.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1.2-4.1">
                <p id="section-4.1.1.2-4.1.1">The challenge received from the KDC in the 'kdcchallenge' parameter of the 2.01 (Created) response to the Token Transfer Request (see <a href="#token-post" class="auto internal xref">Section 3.6</a>).<a href="#section-4.1.1.2-4.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1.2-4.2">
                <p id="section-4.1.1.2-4.2.1">If the provisioning of the access token to the KDC has relied on the DTLS profile of ACE <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span>, and the access token was specified in the "psk_identity" field of the ClientKeyExchange message when using DTLS 1.2 <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span>, then N_S is an exporter value computed as defined in <span><a href="https://rfc-editor.org/rfc/rfc5705#section-4" class="relref">Section 4</a> of [<a href="#RFC5705" class="cite xref">RFC5705</a>]</span> (REQ15).<a href="#section-4.1.1.2-4.2.1" class="pilcrow">¶</a></p>
<p id="section-4.1.1.2-4.2.2">
Specifically, N_S is exported from the DTLS session between the joining node and the KDC, using an empty context value (i.e., a context value of zero-length), 32 as length value in bytes, and the exporter label "EXPORTER-ACE-Sign-Challenge-pubsub-app" defined in <a href="#tls_exporter" class="auto internal xref">Section 9.6</a> of this document.<a href="#section-4.1.1.2-4.2.2" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1.2-4.3">
                <p id="section-4.1.1.2-4.3.1">If the provisioning of the access token to the KDC has relied on the DTLS profile of ACE <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span>, and the access token was specified in the "identity" field of a PskIdentity within the PreSharedKeyExtension of the ClientHello message when using DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>, then N_S is an exporter value computed as defined in <span><a href="https://rfc-editor.org/rfc/rfc8446#section-7.5" class="relref">Section 7.5</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> (REQ15).<a href="#section-4.1.1.2-4.3.1" class="pilcrow">¶</a></p>
<p id="section-4.1.1.2-4.3.2">
Specifically, N_S is exported from the DTLS session between the joining node and the KDC, using an empty 'context_value' (i.e., a 'context_value' of zero length), 32 as 'key_length' in bytes, and the exporter label "EXPORTER-ACE-Sign-Challenge-pubsub-app" defined in <a href="#tls_exporter" class="auto internal xref">Section 9.6</a> of this document.<a href="#section-4.1.1.2-4.3.2" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1.2-4.4">
                <p id="section-4.1.1.2-4.4.1">If the Join Request is a retry in response to an error response from the KDC, which included a new 'kdcchallenge' parameter, then N_S <span class="bcp14">MUST</span> be the new value from this parameter.<a href="#section-4.1.1.2-4.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.1.1.2-5">It is up to applications to define how N_S is computed in further alternative settings.<a href="#section-4.1.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="join-response">
<section id="section-4.1.2">
          <h4 id="name-join-response">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-join-response" class="section-name selfRef">Join Response</a>
          </h4>
<p id="section-4.1.2-1">Upon receiving the Join Request, the KDC processes it as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, and returns a success or error response.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">If the 'client_cred' parameter is present, the KDC verifies the signature in the 'client_cred_verify' parameter. As PoP input, the KDC uses the value of the 'scope' parameter from the Join Request as a CBOR byte string, concatenated with N_S encoded as a CBOR byte string, concatenated with N_C encoded as a CBOR byte string.<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-3">As public key of the joining node, the KDC uses either the one included in the authentication credential retrieved from the 'client_cred' parameter of the Join Request, or the one from the already stored authentication credential from previous interactions with the joining node. The KDC verifies the signature used as PoP evidence by means of the public key of the joining node, according to the signature algorithm used in the group and possible corresponding parameters.<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2-4">In case of any Join Request error, the KDC and the joining node follow the procedure defined in <a href="#join-error" class="auto internal xref">Section 4.1.3</a>.<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<p id="section-4.1.2-5">In case of success, the KDC responds with a Join Response, whose payload is formatted as a CBOR map and <span class="bcp14">MUST</span> contain the following fields as per <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>:<a href="#section-4.1.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-6.1">
              <p id="section-4.1.2-6.1.1">'gkty': this field specifies the key type "Group_PubSub_Keying_Material" (REQ18) registered in <a href="#iana-ace-groupcomm-key" class="auto internal xref">Section 9.1</a> for the 'key' parameter.<a href="#section-4.1.2-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.2-6.2">
              <p id="section-4.1.2-6.2.1">'key': this field specifies the keying material to use for secure communication in the group (REQ17). This field has as value a CBOR map that includes the following parameters.<a href="#section-4.1.2-6.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-6.2.2.1">
                  <p id="section-4.1.2-6.2.2.1.1">'group_key': this parameter is identified by the CBOR unsigned integer 0 used as map key. Its value is a COSE_Key object as defined in <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span> and conveying the group key to use in the security group.<a href="#section-4.1.2-6.2.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6.2.2.1.2">
The COSE_Key object <span class="bcp14">MUST</span> contain the following parameters:<a href="#section-4.1.2-6.2.2.1.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-6.2.2.1.3.1">
                      <p id="section-4.1.2-6.2.2.1.3.1.1">'kty', with value 4 (Symmetric).<a href="#section-4.1.2-6.2.2.1.3.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.1.2-6.2.2.1.3.2">
                      <p id="section-4.1.2-6.2.2.1.3.2.1">'alg', with value the identifier of the AEAD algorithm used in the security group. The value is taken from the "Value" column of the "COSE Algorithms" registry <span>[<a href="#IANA.cose_algorithms" class="cite xref">IANA.cose_algorithms</a>]</span>.<a href="#section-4.1.2-6.2.2.1.3.2.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.1.2-6.2.2.1.3.3">
                      <p id="section-4.1.2-6.2.2.1.3.3.1">'Base IV', with value the Base Initialization Vector (Base IV) to use in the security group with this group key.<a href="#section-4.1.2-6.2.2.1.3.3.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.1.2-6.2.2.1.3.4">
                      <p id="section-4.1.2-6.2.2.1.3.4.1">'k', with value the symmetric encryption key to use as group key.<a href="#section-4.1.2-6.2.2.1.3.4.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.1.2-6.2.2.1.3.5">
                      <p id="section-4.1.2-6.2.2.1.3.5.1">'kid', with value the identifier of the COSE_Key object, hence of the group key.<a href="#section-4.1.2-6.2.2.1.3.5.1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6.2.2.1.3.5.2">
This value is used as Group Identifier (Gid) of the security group, as long as the present key is used as group key in the security group.<a href="#section-4.1.2-6.2.2.1.3.5.2" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal" id="section-4.1.2-6.2.2.2">
                  <p id="section-4.1.2-6.2.2.2.1">'group_SenderId': this parameter is identified by the CBOR unsigned integer 1 used as map key. Its value is the Client's Sender ID encoded as a CBOR byte string. This parameter <span class="bcp14">MUST</span> be included if the Client is joining the security group as a Publisher, and <span class="bcp14">MUST NOT</span> be included otherwise. A Publisher Client <span class="bcp14">MUST</span> support the 'group_SenderId' parameter (REQ29).<a href="#section-4.1.2-6.2.2.2.1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6.2.2.2.2">
The Sender ID <span class="bcp14">MUST</span> be unique within the security group. The KDC <span class="bcp14">MUST</span> only assign an available Sender ID that has not been used in the security group since the last time when the current Gid value was assigned to the group (i.e., since the latest group rekeying, see <a href="#rekeying" class="auto internal xref">Section 5</a>). The KDC <span class="bcp14">MUST NOT</span> assign a Sender ID to the joining node if the node is not joining the group as a Publisher.<a href="#section-4.1.2-6.2.2.2.2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6.2.2.2.3">
The Sender ID can be short in length. Its maximum length in bytes is the length in bytes of the AEAD nonce for the AEAD algorithm, minus 6. This means that, when using AES-CCM-16-64-128 as AEAD algorithm in the security group, the maximum length of Sender IDs is 7 bytes.<a href="#section-4.1.2-6.2.2.2.3" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.1.2-6.2.2.3">
                  <p id="section-4.1.2-6.2.2.3.1">'cred_fmt': this parameter is identified by the CBOR unsigned integer 2 used as map key. Its value specifies the format of authentication credentials used in the group, and is taken from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#IANA.cose_header-parameters" class="cite xref">IANA.cose_header-parameters</a>]</span>.<a href="#section-4.1.2-6.2.2.3.1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6.2.2.3.2">
At the time of writing this specification, acceptable formats of authentication credentials are CBOR Web Tokens (CWTs) and CWT Claims Sets (CCSs) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, X.509 certificates <span>[<a href="#RFC7925" class="cite xref">RFC7925</a>]</span>, and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. Further formats may be available in the future, and would be acceptable to use as long as they comply with the criteria defined above (REQ6).<a href="#section-4.1.2-6.2.2.3.2" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.1.2-6.2.2.4">
                  <p id="section-4.1.2-6.2.2.4.1">'sign_alg': this parameter is identified by the CBOR unsigned integer 3 used as map key. Its value specifies the Signature Algorithm used to sign messages in the group, and is taken from the "Value" column of the "COSE Algorithms" registry <span>[<a href="#IANA.cose_algorithms" class="cite xref">IANA.cose_algorithms</a>]</span>.<a href="#section-4.1.2-6.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.1.2-6.2.2.5">
                  <p id="section-4.1.2-6.2.2.5.1">'sign_params': this parameter is identified by the CBOR unsigned integer 4 used as map key. Its value specifies the parameters of the Signature Algorithm, and is encoded as a CBOR array including the following two elements:<a href="#section-4.1.2-6.2.2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-6.2.2.5.2.1">
                      <p id="section-4.1.2-6.2.2.5.2.1.1">'sign_alg_capab' is a CBOR array, with the same format and value of the COSE capabilities array for the Signature Algorithm indicated in 'sign_alg', as specified for that algorithm in the "Capabilities" column of the "COSE Algorithms" registry <span>[<a href="#IANA.cose_algorithms" class="cite xref">IANA.cose_algorithms</a>]</span>.<a href="#section-4.1.2-6.2.2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.1.2-6.2.2.5.2.2">
                      <p id="section-4.1.2-6.2.2.5.2.2.1">'sign_key_type_capab' is a CBOR array, with the same format and value of the COSE capabilities array for the COSE key type of the keys used with the Signature Algorithm indicated in 'sign_alg', as specified for that key type in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#IANA.cose_key-type" class="cite xref">IANA.cose_key-type</a>]</span>.<a href="#section-4.1.2-6.2.2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li class="normal" id="section-4.1.2-6.3">
              <p id="section-4.1.2-6.3.1">'num', specifying the version number of the keying material specified in the 'key' field. The initial value of the version number <span class="bcp14">MUST</span> be set to 0 upon creating the group (REQ16).<a href="#section-4.1.2-6.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.2-6.4">
              <p id="section-4.1.2-6.4.1">'exi', which <span class="bcp14">MUST</span> be present.<a href="#section-4.1.2-6.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.2-6.5">
              <p id="section-4.1.2-6.5.1">'ace-groupcomm-profile', which <span class="bcp14">MUST</span> be present and has value "coap_group_pubsub_app" (PROFILE_TBD), which is registered in <a href="#iana-profile" class="auto internal xref">Section 9.2</a> (REQ19).<a href="#section-4.1.2-6.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.2-6.6">
              <p id="section-4.1.2-6.6.1">'creds', which <span class="bcp14">MUST</span> be present if the 'get_creds' parameter was present in the Join Request, and <span class="bcp14">MUST NOT</span> be present otherwise. It specifies the authentication credentials of all the Publishers in the security group.<a href="#section-4.1.2-6.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.2-6.7">
              <p id="section-4.1.2-6.7.1">'peer_roles', which <span class="bcp14">MAY</span> be omitted even if 'creds' is present, since: i) each authentication credential conveyed in the 'creds' parameter is associated with a Client authorised to be Publisher in the group; and ii) it is irrelevant whether such a Client is also authorised to be Subscriber in the group. If 'creds' is not present, 'peer_roles' <span class="bcp14">MUST NOT</span> be present.<a href="#section-4.1.2-6.7.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.2-6.8">
              <p id="section-4.1.2-6.8.1">'peer_identifiers', which <span class="bcp14">MUST</span> be present if 'creds' is also present, and <span class="bcp14">MUST NOT</span> be present otherwise. The identifiers are the Publisher Sender IDs, whose corresponding authentication credentials are specified in the 'creds' parameter (REQ25).<a href="#section-4.1.2-6.8.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.2-6.9">
              <p id="section-4.1.2-6.9.1">'kdc_cred', which <span class="bcp14">MUST</span> be present if group re-keying is used. It is encoded as a CBOR byte string, with value the original binary representation of the KDC's authentication credential (REQ8).<a href="#section-4.1.2-6.9.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.2-6.10">
              <p id="section-4.1.2-6.10.1">'kdc_nonce', which <span class="bcp14">MUST</span> be present if 'kdc_cred' is present. It is encoded as a CBOR byte string, with value a dedicated nonce N_KDC generated by the KDC. For N_KDC, it is <span class="bcp14">RECOMMENDED</span> to use an 8-byte long random nonce.<a href="#section-4.1.2-6.10.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.2-6.11">
              <p id="section-4.1.2-6.11.1">'kdc_cred_verify', which <span class="bcp14">MUST</span> be present if 'kdc_cred' is present. It is encoded as a CBOR byte string. The KDC <span class="bcp14">MUST</span> compute the specified PoP evidence as a signature by using the signature algorithm used in the group, as well as its own private key associated with the authentication credential specified in the 'kdc_cred' parameter (REQ21).<a href="#section-4.1.2-6.11.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.2-6.12">
              <p id="section-4.1.2-6.12.1">'group_rekeying', which <span class="bcp14">MAY</span> be omitted if the KDC uses the "Point-to-Point" group rekeying scheme registered in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-11.13" class="relref">Section 11.13</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> as the default rekeying scheme in the group (OPT9). In any other case, the 'group_rekeying' parameter <span class="bcp14">MUST</span> be included.<a href="#section-4.1.2-6.12.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.1.2-7">After sending a successful Join Response, the KDC adds the Client to the list of current members of the security group, if that Client is not already a group member. Also, the Client is assigned a name NODENAME and a sub-resource /ace-group/GROUPNAME/nodes/NODENAME at the KDC. Furthermore, the KDC associates NODENAME with the Client's access token and with the secure communication association that the KDC has with the Client. If the Client is a Publisher, its authentication credential is also associated with the tuple containing NODENAME, GROUPNAME, the current Gid, the newly assigned Publisher's Sender ID, and the Client's access token. The KDC <span class="bcp14">MUST</span> keep this association updated over time.<a href="#section-4.1.2-7" class="pilcrow">¶</a></p>
<p id="section-4.1.2-8">Note that, as long as the secure communication association between the Client and the KDC persists, the same Client re-joining the group is recognized by the KDC by virtue of such a secure communication association. As a consequence, the re-joining Client keeps the same NODENAME and the associated subresource /ace-group/GROUPNAME/nodes/NODENAME. Also, if the Client is a Publisher, it receives a new Sender ID according to the same criteria defined above.<a href="#section-4.1.2-8" class="pilcrow">¶</a></p>
<p id="section-4.1.2-9">If the application requires backward security, the KDC <span class="bcp14">MUST</span> generate updated security parameters and group keying material, and provide it to the current group members upon the new node's joining (see <a href="#rekeying" class="auto internal xref">Section 5</a>). In such a case, the joining node is not able to access secure communication in the Pub-Sub group prior its joining.<a href="#section-4.1.2-9" class="pilcrow">¶</a></p>
<p id="section-4.1.2-10">Upon receiving the Join Response, the joining node retrieves the KDC's authentication credential from the 'kdc_cred' parameter (if present). The joining node <span class="bcp14">MUST</span> verify the signature used as proof-of-possession (PoP) evidence, which is specified by the 'kdc_cred_verify' parameter of the Join Response (REQ21).<a href="#section-4.1.2-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="join-error">
<section id="section-4.1.3">
          <h4 id="name-join-error-handling">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-join-error-handling" class="section-name selfRef">Join Error Handling</a>
          </h4>
<p id="section-4.1.3-1">The KDC <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response (OPT4) to the Join Request in the following cases:<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.3-2.1">
              <p id="section-4.1.3-2.1.1">The 'client_cred' parameter is present in the Join Request and its value is not an eligible authentication credential (e.g., it is not of the format accepted in the group) (OPT8).<a href="#section-4.1.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.3-2.2">
              <p id="section-4.1.3-2.2.1">The 'client_cred' parameter is present, but the 'cnonce' and 'client_cred_verify' parameters are not present.<a href="#section-4.1.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.3-2.3">
              <p id="section-4.1.3-2.3.1">The 'client_cred' parameter is not present while the joining node is not requesting to join the group exclusively as a Subscriber, and any of the following conditions holds:<a href="#section-4.1.3-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.3-2.3.2.1">
                  <p id="section-4.1.3-2.3.2.1.1">The KDC does not store an eligible authentication credential for the joining node (e.g., of the format accepted in the group).<a href="#section-4.1.3-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.1.3-2.3.2.2">
                  <p id="section-4.1.3-2.3.2.2.1">The KDC stores multiple eligible authentication credentials for the joining node (e.g., of the format accepted in the group).<a href="#section-4.1.3-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-4.1.3-2.4">
              <p id="section-4.1.3-2.4.1">The 'scope' parameter is not present in the Join Request, or it is present and specifies any set of permissions not included in the list defined in <a href="#scope" class="auto internal xref">Section 3.4.1</a>.<a href="#section-4.1.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.1.3-3">A 4.00 (Bad Request) error response from the KDC to the joining node <span class="bcp14">MAY</span> have content format application/ace-groupcomm+cbor and contain a CBOR map as payload.<a href="#section-4.1.3-3" class="pilcrow">¶</a></p>
<p id="section-4.1.3-4">The CBOR map <span class="bcp14">MAY</span> include the 'kdcchallenge' parameter. If present, this parameter is a CBOR byte string, with value a newly generated 'kdcchallenge' value that the Client can use when preparing a new Join Request. In such a case, the KDC <span class="bcp14">MUST</span> store the newly generated value as the 'kdcchallenge' value associated with the joining node, which replaces the currently stored value (if any).<a href="#section-4.1.3-4" class="pilcrow">¶</a></p>
<p id="section-4.1.3-5">Upon receiving the Join Response, if 'kdc_cred' is present but the Client cannot verify the PoP evidence, the Client <span class="bcp14">MUST</span> stop processing the Join Response and <span class="bcp14">MAY</span> send a new Join Request to the KDC.<a href="#section-4.1.3-5" class="pilcrow">¶</a></p>
<p id="section-4.1.3-6">The KDC <span class="bcp14">MUST</span> return a 5.03 (Service Unavailable) response to a Client that sends a Join Request to join the security group as Publisher, in case there are currently no Sender IDs available to assign. The response <span class="bcp14">MUST</span> have Content-Format set to application/concise-problem-details+cbor and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 4 ("No available individual keying material").<a href="#section-4.1.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="other-group-operations-through-the-kdc">
<section id="section-4.2">
        <h3 id="name-other-group-operations-thro">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-other-group-operations-thro" class="section-name selfRef">Other Group Operations through the KDC</a>
        </h3>
<div id="query">
<section id="section-4.2.1">
          <h4 id="name-obtaining-latest-informatio">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-obtaining-latest-informatio" class="section-name selfRef">Obtaining Latest Information on the Group, Group Keying Material, and Sender ID</a>
          </h4>
<p id="section-4.2.1-1">A Client can access the following resources at the KDC, in order to retrieve latest information about the group or the group keying material.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-2.1">
              <p id="section-4.2.1-2.1.1">'/ace-group': All Clients can send a FETCH request to retrieve a set of group names associated with their group identifiers specified in the request payload. Each element of the CBOR array 'gid' is a CBOR byte string (REQ13), which encodes the Gid of the group (see <a href="#join-response" class="auto internal xref">Section 4.1.2</a>) for which the group name and the URI to the group-membership resource are provided in the returned response.<a href="#section-4.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-2.2">
              <p id="section-4.2.1-2.2.1">'/ace-group/GROUPNAME':  All group member Clients can send a GET request to retrieve the symmetric group keying material of the group with the name GROUPNAME. The value of the GROUPNAME URI path and the group name in the access token scope ('gname') <span class="bcp14">MUST</span> coincide.<a href="#section-4.2.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2.2.2">
The KDC processes the Key Distribution Request according to <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.2" class="relref">Section 4.3.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. The Key Distribution Response is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.2" class="relref">Section 4.3.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the following additions.<a href="#section-4.2.1-2.2.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-2.2.3.1">
                  <p id="section-4.2.1-2.2.3.1.1">The 'key' field is formatted as defined in <a href="#join-response" class="auto internal xref">Section 4.1.2</a> of this document, with the difference that it does not include the 'group_SenderId' parameter.<a href="#section-4.2.1-2.2.3.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.1-2.2.3.2">
                  <p id="section-4.2.1-2.2.3.2.1">The 'exi' field <span class="bcp14">MUST</span> be present.<a href="#section-4.2.1-2.2.3.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.1-2.2.3.3">
                  <p id="section-4.2.1-2.2.3.3.1">The 'ace_groupcomm_profile' field <span class="bcp14">MUST</span> be present and has value "coap_group_pubsub_app".<a href="#section-4.2.1-2.2.3.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-4.2.1-2.2.4">
Upon receiving the Key Distribution Response, the requesting group member retrieves the updated security parameters and group keying material. If they differ from the currently stored ones, then the group member uses the received one as group keying material to protect/unprotect published topic data thereafter.<a href="#section-4.2.1-2.2.4" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-2.3">
              <p id="section-4.2.1-2.3.1">'/ace-group/GROUPNAME/creds': The KDC acts as a repository of authentication credentials for the Publishers that are member of the security group with name GROUPNAME. The members of the group that are Subscribers can send GET/FETCH requests to this resource in order to retrieve the authentication credentials of all or a subset of the group members that are Publishers. The KDC silently ignores the Sender IDs included in the 'get_creds' parameter of the request that are not associated with any current Publisher group member (REQ26).<a href="#section-4.2.1-2.3.1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2.3.2">
The response from the KDC <span class="bcp14">MAY</span> omit the parameter 'peer_roles', since: i) each authentication credential conveyed in the 'creds' parameter is associated with a Client authorised to be Publisher in the group; and ii) it is irrelevant whether such a Client is also authorised to be Subscriber in the group. If 'creds' is not present, 'peer_roles' <span class="bcp14">MUST NOT</span> be present.<a href="#section-4.2.1-2.3.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-2.4">
              <p id="section-4.2.1-2.4.1">'/ace-group/GROUPNAME/num': All group member Clients can send a GET request to this resource in order to retrieve the current version number for the symmetric group keying material of the group with name GROUPNAME.<a href="#section-4.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-2.5">
              <p id="section-4.2.1-2.5.1">'/ace-group/GROUPNAME/kdc-cred': All group member Clients can send a GET request to this resource in order to retrieve the current authentication credential of the KDC.<a href="#section-4.2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-2.6">
              <p id="section-4.2.1-2.6.1">'/ace-group/GROUPNAME/nodes/NODENAME': A group member can send a Key Distribution to the KDC by sending a GET request to this resource to retrieve the latest group keying material as well as its Sender ID that it has in the group (if Publisher).<a href="#section-4.2.1-2.6.1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2.6.2">
The KDC processes the Key Distribution Request according to <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.8.1" class="relref">Section 4.8.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. The Key Distribution Response is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.8.1" class="relref">Section 4.8.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the following additions.<a href="#section-4.2.1-2.6.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-2.6.3.1">
                  <p id="section-4.2.1-2.6.3.1.1">The 'key' field is formatted as defined in <a href="#join-response" class="auto internal xref">Section 4.1.2</a> of this document. If the requesting group member is not a Publisher Client, then the 'key' field does not include the 'group_SenderId' parameter.<a href="#section-4.2.1-2.6.3.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.1-2.6.3.2">
                  <p id="section-4.2.1-2.6.3.2.1">The 'exi' field <span class="bcp14">MUST</span> be present.<a href="#section-4.2.1-2.6.3.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-4.2.1-2.6.4">
Upon receiving the Key Distribution Response, the group member retrieves the updated security parameters, group keying material, and Sender ID (if the 'key' field includes the 'group_SenderId' parameter). If they differ from the currently stored ones, then the group member uses the received one as group keying material to protect/unprotect published topic data thereafter.<a href="#section-4.2.1-2.6.4" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sec-key-renewal-request">
<section id="section-4.2.2">
          <h4 id="name-requesting-a-new-sender-id">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-requesting-a-new-sender-id" class="section-name selfRef">Requesting a New Sender ID</a>
          </h4>
<p id="section-4.2.2-1">A Publisher group member with node name NODENAME may at some point exhaust its Sender Sequence Numbers used for protecting its published topic data (see <a href="#oscon" class="auto internal xref">Section 6.1</a>).<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">When this happens, the Publisher <span class="bcp14">MUST</span> send a Key Renewal Request message to the KDC, as per <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.8.2.1" class="relref">Section 4.8.2.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. That is, it sends a CoAP POST request to the endpoint /ace-group/GROUPNAME/nodes/NODENAME at the KDC.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2.2-3">Upon receiving the Key Renewal Request, the KDC processes it as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.8.2" class="relref">Section 4.8.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the addition that the KDC takes one of the following actions.<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2-4.1">
              <p id="section-4.2.2-4.1.1">The KDC rekeys the group. That is, the KDC generates new group keying material for that group (see <a href="#rekeying" class="auto internal xref">Section 5</a>), and replies to the Publisher with a group rekeying message as defined in <a href="#rekeying" class="auto internal xref">Section 5</a>, providing the new group keying material. Then, the KDC rekeys the rest of the group, as discussed in <a href="#rekeying" class="auto internal xref">Section 5</a>.<a href="#section-4.2.2-4.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-4.1.2">
The KDC <span class="bcp14">SHOULD</span> perform a group rekeying only if already scheduled to occur shortly, e.g., according to an application-specific rekeying period or scheduling, or as a reaction to a recent change in the group membership. In any other case, the KDC <span class="bcp14">SHOULD NOT</span> rekey the OSCORE group when receiving a Key Renewal Request (OPT12).<a href="#section-4.2.2-4.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.2-4.2">
              <p id="section-4.2.2-4.2.1">The KDC determines and assigns a new Sender ID for the Publisher, and replies with a Key Renewal Response formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.8.2" class="relref">Section 4.8.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. The CBOR Map in the response payload includes only the parameter 'group_SenderId' registered in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-16#section-16.3" class="relref">Section 16.3</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>, and specifies the new Sender ID of the Publisher encoded as a CBOR byte string.<a href="#section-4.2.2-4.2.1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-4.2.2">
The KDC <span class="bcp14">MUST</span> assign a new Sender ID that has not been used in the group since the latest time when the current Gid value was assigned to the group (i.e., since the latest group rekeying, see <a href="#rekeying" class="auto internal xref">Section 5</a>).<a href="#section-4.2.2-4.2.2" class="pilcrow">¶</a></p>
<p id="section-4.2.2-4.2.3">
The KDC <span class="bcp14">MUST</span> return a 5.03 (Service Unavailable) response in case there are currently no Sender IDs available to assign in the group. The response <span class="bcp14">MUST</span> have Content-Format set to application/concise-problem-details+cbor and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 4 ("No available individual keying material").<a href="#section-4.2.2-4.2.3" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="updating-authentication-credentials">
<section id="section-4.2.3">
          <h4 id="name-updating-authentication-cre">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-updating-authentication-cre" class="section-name selfRef">Updating Authentication Credentials</a>
          </h4>
<p id="section-4.2.3-1">A Publisher group member with node name NODENAME can contact the KDC to upload a new authentication credential to use in the security group with name GROUPNAME, and replace the currently stored one.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-2">To this end, the Publisher sends a CoAP POST request to its associated sub-resource /ace-group/GROUPNAME/nodes/NODENAME/cred at the KDC (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.9.1" class="relref">Section 4.9.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>).<a href="#section-4.2.3-2" class="pilcrow">¶</a></p>
<p id="section-4.2.3-3">Following a successful processing of the request, the KDC replaces the stored authentication credential of this Client for the group GROUPNAME with the one specified in the request.<a href="#section-4.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-group-leaving">
<section id="section-4.2.4">
          <h4 id="name-leaving-a-group">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-leaving-a-group" class="section-name selfRef">Leaving a Group</a>
          </h4>
<p id="section-4.2.4-1">A group member with node name NODENAME can actively request to leave the security group with name GROUPNAME.<a href="#section-4.2.4-1" class="pilcrow">¶</a></p>
<p id="section-4.2.4-2">To this end, the Client sends a CoAP DELETE request to the associated sub-resource /ace-group/GROUPNAME/nodes/NODENAME at the KDC (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.8.3" class="relref">Section 4.8.3</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>).<a href="#section-4.2.4-2" class="pilcrow">¶</a></p>
<p id="section-4.2.4-3">The KDC can also remove a group member due to any of the reasons described in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-5" class="relref">Section 5</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-4.2.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="rekeying">
<section id="section-5">
      <h2 id="name-group-rekeying-process">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-group-rekeying-process" class="section-name selfRef">Group Rekeying Process</a>
      </h2>
<p id="section-5-1">Rekeying a group consists in the KDC generating and distributing a new symmetric key, which is used as group key from then on to protect the publication of topic data with COSE (see <a href="#oscon" class="auto internal xref">Section 6.1</a>).<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The KDC <span class="bcp14">MUST</span> trigger a group rekeying as described in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-6" class="relref">Section 6</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, upon a change in the group membership or due to the current group keying material approaching its expiration time. In addition, the KDC <span class="bcp14">MAY</span> perform regularly scheduled group rekeying executions.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Upon generating the new group key and before starting its distribution:<a href="#section-5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.1">
          <p id="section-5-4.1.1">The KDC <span class="bcp14">MUST</span> increment the version number of the group keying material.<a href="#section-5-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-4.2">
          <p id="section-5-4.2.1">The KDC <span class="bcp14">MUST</span> generate a new Group Identifier (Gid) for the group. This is used as identifier of the new group key, when providing it to the current group members through the group rekeying, and to Clients (re-)joining the security group thereafter (see <a href="#join-response" class="auto internal xref">Section 4.1.2</a>).<a href="#section-5-4.2.1" class="pilcrow">¶</a></p>
<p id="section-5-4.2.2">
That is, the value of the new Gid is specified by the 'kid' parameter of the COSE_Key Object that is used to encode the new group key.<a href="#section-5-4.2.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-5">When rekeying the group, the KDC <span class="bcp14">MUST</span> preserve the current value of the Sender ID of each member in that group.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">The default rekeying scheme is "Point-to-Point" (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>), where the KDC individually targets each node to rekey, using the pairwise secure communication association with that node.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">In particular, a group rekeying message <span class="bcp14">MUST</span> have Content-Format set to application/ace-groupcomm+cbor and have the same format used for the Join Response message defined in <a href="#join-response" class="auto internal xref">Section 4.1.2</a>, with the following differences:<a href="#section-5-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-8.1">
          <p id="section-5-8.1.1">Within the 'key' field, only the parameter 'group_key' is present.<a href="#section-5-8.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-8.2">
          <p id="section-5-8.2.1">The fields 'kdc_cred' ,'kdc_nonce', 'kdc_cred_verify', and 'group_rekeying' are not present.<a href="#section-5-8.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-8.3">
          <p id="section-5-8.3.1">The fields 'creds' and 'peer_identifiers' <span class="bcp14">SHOULD</span> be present, if the group rekeying is performed due to one or multiple Clients joining the group as Publishers. Following the same semantics used in the Join Response message, the two parameters specify the authentication credentials and Sender IDs of such Clients. Like in the Join Response message, the 'peer_roles' parameter <span class="bcp14">MAY</span> be omitted.<a href="#section-5-8.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="protected_communication">
<section id="section-6">
      <h2 id="name-pub-sub-protected-communica">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-pub-sub-protected-communica" class="section-name selfRef">Pub-Sub Protected Communication</a>
      </h2>
<p id="section-6-1">In the diagram shown in <a href="#pubsub-3" class="auto internal xref">Figure 7</a>, (D) corresponds to the publication on a topic at the Broker, by using a CoAP PUT request. The Publisher protects the published topic data end-to-end for the Subscribers by using COSE (<span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span><span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span><span>[<a href="#RFC9338" class="cite xref">RFC9338</a>]</span>), as detailed in <a href="#oscon" class="auto internal xref">Section 6.1</a>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">In the same diagram, (E) corresponds to the subscription of a Subscriber to the same topic, by means of a CoAP GET request with the Observe option set to 0 (register) <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>, as per <span>[<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>. Finally, (F) corresponds to the Observe notification response from the Broker to the Subscriber, where the published topic data is conveyed as originally protected end-to-end with COSE by the Publisher.<a href="#section-6-2" class="pilcrow">¶</a></p>
<span id="name-secure-pub-sub-communicatio"></span><div id="pubsub-3">
<figure id="figure-7">
        <div id="section-6-3.1">
          <div class="alignCenter art-svg artwork" id="section-6-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="176" width="520" viewBox="0 0 520 176" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,160" fill="none" stroke="black"></path>
              <path d="M 104,32 L 104,160" fill="none" stroke="black"></path>
              <path d="M 216,32 L 216,160" fill="none" stroke="black"></path>
              <path d="M 288,32 L 288,160" fill="none" stroke="black"></path>
              <path d="M 408,32 L 408,160" fill="none" stroke="black"></path>
              <path d="M 512,32 L 512,160" fill="none" stroke="black"></path>
              <path d="M 8,32 L 104,32" fill="none" stroke="black"></path>
              <path d="M 216,32 L 288,32" fill="none" stroke="black"></path>
              <path d="M 408,32 L 512,32" fill="none" stroke="black"></path>
              <path d="M 120,64 L 136,64" fill="none" stroke="black"></path>
              <path d="M 184,64 L 200,64" fill="none" stroke="black"></path>
              <path d="M 304,96 L 328,96" fill="none" stroke="black"></path>
              <path d="M 376,96 L 392,96" fill="none" stroke="black"></path>
              <path d="M 304,128 L 328,128" fill="none" stroke="black"></path>
              <path d="M 376,128 L 392,128" fill="none" stroke="black"></path>
              <path d="M 8,160 L 104,160" fill="none" stroke="black"></path>
              <path d="M 216,160 L 288,160" fill="none" stroke="black"></path>
              <path d="M 408,160 L 512,160" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="400,128 388,122.4 388,133.6" fill="black" transform="rotate(0,392,128)"></polygon>
              <polygon class="arrowhead" points="312,96 300,90.4 300,101.6" fill="black" transform="rotate(180,304,96)"></polygon>
              <polygon class="arrowhead" points="208,64 196,58.4 196,69.6" fill="black" transform="rotate(0,200,64)"></polygon>
              <g class="text">
                <text x="160" y="68">(D)</text>
                <text x="56" y="100">Publisher</text>
                <text x="252" y="100">Broker</text>
                <text x="352" y="100">(E)</text>
                <text x="460" y="100">Subscriber</text>
                <text x="352" y="132">(F)</text>
              </g>
            </svg><a href="#section-6-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-secure-pub-sub-communicatio" class="selfRef">Secure Pub-Sub Communication between Publisher and Subscriber</a>
        </figcaption></figure>
</div>
<p id="section-6-4"><a href="#flow" class="auto internal xref">Figure 8</a> provides a more detailed example of such a secure Pub-Sub communication. All the messages exchanged between a Client and the Broker are protected with the secure communication association between that Client and the Broker. In addition, COSE is used to protect end-to-end the published topic data, which is conveyed in a PUT request from the Publisher to the topic-data resource at the Broker and in a 2.05 (Content) response from that resource to a Subscriber.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">The example also shows a delete operation, where the Publisher deletes the topic-data resource by sending a CoAP DELETE request to the URI of that resource. In case of success, the Broker replies with a 2.02 (Deleted) response. Consequently, the Broker also unsubscribes all the Clients subscribed to that topic-data resource, by removing them from the list of observers and sending them a final 4.04 (Not Found) response as per <span><a href="https://rfc-editor.org/rfc/rfc7641#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>.<a href="#section-6-5" class="pilcrow">¶</a></p>
<span id="name-example-of-secure-pub-sub-c"></span><div id="flow">
<figure id="figure-8">
        <div id="section-6-6.1">
          <div class="alignCenter art-svg artwork" id="section-6-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="320" width="568" viewBox="0 0 568 320" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,48 L 8,304" fill="none" stroke="black"></path>
              <path d="M 296,48 L 296,304" fill="none" stroke="black"></path>
              <path d="M 560,48 L 560,304" fill="none" stroke="black"></path>
              <path d="M 8,64 L 40,64" fill="none" stroke="black"></path>
              <path d="M 256,64 L 288,64" fill="none" stroke="black"></path>
              <path d="M 16,96 L 64,96" fill="none" stroke="black"></path>
              <path d="M 184,96 L 296,96" fill="none" stroke="black"></path>
              <path d="M 304,128 L 320,128" fill="none" stroke="black"></path>
              <path d="M 544,128 L 560,128" fill="none" stroke="black"></path>
              <path d="M 296,176 L 344,176" fill="none" stroke="black"></path>
              <path d="M 464,176 L 552,176" fill="none" stroke="black"></path>
              <path d="M 8,224 L 24,224" fill="none" stroke="black"></path>
              <path d="M 272,224 L 288,224" fill="none" stroke="black"></path>
              <path d="M 16,256 L 48,256" fill="none" stroke="black"></path>
              <path d="M 168,256 L 296,256" fill="none" stroke="black"></path>
              <path d="M 296,288 L 344,288" fill="none" stroke="black"></path>
              <path d="M 480,288 L 552,288" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="560,288 548,282.4 548,293.6" fill="black" transform="rotate(0,552,288)"></polygon>
              <polygon class="arrowhead" points="560,176 548,170.4 548,181.6" fill="black" transform="rotate(0,552,176)"></polygon>
              <polygon class="arrowhead" points="312,128 300,122.4 300,133.6" fill="black" transform="rotate(180,304,128)"></polygon>
              <polygon class="arrowhead" points="296,224 284,218.4 284,229.6" fill="black" transform="rotate(0,288,224)"></polygon>
              <polygon class="arrowhead" points="296,64 284,58.4 284,69.6" fill="black" transform="rotate(0,288,64)"></polygon>
              <polygon class="arrowhead" points="24,256 12,250.4 12,261.6" fill="black" transform="rotate(180,16,256)"></polygon>
              <polygon class="arrowhead" points="24,96 12,90.4 12,101.6" fill="black" transform="rotate(180,16,96)"></polygon>
              <g class="text">
                <text x="40" y="36">Publisher</text>
                <text x="300" y="36">Broker</text>
                <text x="524" y="36">Subscriber</text>
                <text x="68" y="68">0.03</text>
                <text x="104" y="68">PUT</text>
                <text x="184" y="68">ps/data/1bd0d6d</text>
                <text x="92" y="100">2.01</text>
                <text x="144" y="100">Created</text>
                <text x="348" y="132">0.01</text>
                <text x="384" y="132">GET</text>
                <text x="468" y="132">/ps/data/1bd0d6d</text>
                <text x="368" y="148">Observe:0</text>
                <text x="372" y="180">2.05</text>
                <text x="424" y="180">Content</text>
                <text x="388" y="196">Observe:</text>
                <text x="448" y="196">10001</text>
                <text x="52" y="228">0.04</text>
                <text x="100" y="228">DELETE</text>
                <text x="196" y="228">/ps/data/1bd0d6d</text>
                <text x="76" y="260">2.02</text>
                <text x="128" y="260">Deleted</text>
                <text x="372" y="292">4.04</text>
                <text x="408" y="292">Not</text>
                <text x="448" y="292">Found</text>
              </g>
            </svg><a href="#section-6-6.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-example-of-secure-pub-sub-c" class="selfRef">Example of Secure Pub-Sub Communication using CoAP</a>
        </figcaption></figure>
</div>
<div id="oscon">
<section id="section-6.1">
        <h3 id="name-using-cose-to-protect-the-p">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-using-cose-to-protect-the-p" class="section-name selfRef">Using COSE to Protect the Published Topic Data</a>
        </h3>
<p id="section-6.1-1">The Publisher uses the symmetric COSE Key received from the KDC to protect the payload of the Publish operation (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-16#section-3.2.1" class="relref">Section 3.2.1</a> of [<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>). Specifically, the Publisher creates a COSE_Encrypt0 object <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span><span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> by means of the COSE Key currently used as group key. The encryption algorithm and Base IV to use are specified by the 'alg' and 'Base IV' parameters of the COSE Key, together with its key identifier in the 'kid' parameter.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Also, the Publisher uses its private key corresponding to the public key sent to the KDC, in order to countersign the COSE_Encrypt0 object as specified in <span>[<a href="#RFC9338" class="cite xref">RFC9338</a>]</span>. The countersignature is specified in the 'Countersignature version 2' parameter, within the 'unprotected' field of the COSE_Encrypt0 object.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">Finally, the Publisher sends the COSE_Encrypt0 object conveying the countersignature to the Broker, as payload of the PUT request sent to the topic-data of the topic targeted by the Publish operation.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">Upon receiving a response from the topic-data resource at the Broker, the Subscriber uses the 'kid' parameter from the 'Countersignature version 2' parameter within the 'unprotected' field of the COSE_Encrypt0 object, in order to retrieve the Publisher's public key from the Broker or from its local storage. Then, the Subscriber uses that public key to verify the countersignature.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">In case of successful verification, the Subscriber uses the 'kid' parameter from the 'unprotected' field of the COSE_Encrypt0 object, in order to retrieve the COSE Key used as current group key from its local storage. Then, the Subscriber uses that group key to verify and decrypt the COSE_Encrypt0 object. In case of successful verification, the Subscriber delivers the received topic data to the application.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">The COSE_Encrypt0 object is constructed as follows.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">The 'protected' field <span class="bcp14">MUST</span> include:<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-8.1">
            <p id="section-6.1-8.1.1">The 'alg' parameter, with value the identifier of the AEAD algorithm specified in the 'alg' parameter of the COSE Key used as current group key.<a href="#section-6.1-8.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.1-9">The 'unprotected' field <span class="bcp14">MUST</span> include:<a href="#section-6.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-10.1">
            <p id="section-6.1-10.1.1">The 'kid' parameter, with the same value specified in the 'kid' parameter of the COSE Key used as current group key. This value represents the current Group ID (Gid) of the security group associated with the application group (topic).<a href="#section-6.1-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-10.2">
            <p id="section-6.1-10.2.1">The 'Partial IV' parameter, with value set to the current Sender Sequence Number of the Publisher. All leading bytes of value zero <span class="bcp14">SHALL</span> be removed when encoding the Partial IV, except in the case of Partial IV value 0, which is encoded to the byte string 0x00.<a href="#section-6.1-10.2.1" class="pilcrow">¶</a></p>
<p id="section-6.1-10.2.2">
The Publisher <span class="bcp14">MUST</span> initialize the Sender Sequence Number to 0 upon joining the security group, and <span class="bcp14">MUST</span> reset it to 0 upon receiving a new group key as result of a group rekeying (see <a href="#rekeying" class="auto internal xref">Section 5</a>). The Publisher <span class="bcp14">MUST</span> increment its Sender Sequence Number value by 1, after having completed an encryption operation by means of the current group key.<a href="#section-6.1-10.2.2" class="pilcrow">¶</a></p>
<p id="section-6.1-10.2.3">
When the Publisher exhausts its Sender Sequence Numbers, the Publisher <span class="bcp14">MUST NOT</span> protect further topic data by using the current group key while still retaining its current Sender ID, and <span class="bcp14">MUST</span> send a Key Renewal Request message to the KDC (see <a href="#sec-key-renewal-request" class="auto internal xref">Section 4.2.2</a>). This will result in the KDC rekeying the group and distributing a new group key, or in the KDC providing the Publisher with a new Sender ID. The Publisher <span class="bcp14">MUST</span> reset its Sender Sequence Number to 0 upon receiving a new Sender ID from the KDC.<a href="#section-6.1-10.2.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-10.3">
            <p id="section-6.1-10.3.1">The 'Countersignature version 2' parameter, specifying the countersignature of the COSE_Encrypt0 object. In particular:<a href="#section-6.1-10.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-10.3.2.1">
                <p id="section-6.1-10.3.2.1.1">The 'protected' field includes the 'alg' parameter, with value the identifier of the Signature Algorithm used in the security group.<a href="#section-6.1-10.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-10.3.2.2">
                <p id="section-6.1-10.3.2.2.1">The 'unprotected' field includes the 'kid' parameter, with value the Publisher's Sender ID that the Publisher obtained from the KDC when joining the security group, as value of the 'group_SenderId' parameter of the Join Response (see <a href="#join-response" class="auto internal xref">Section 4.1.2</a>).<a href="#section-6.1-10.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-10.3.2.3">
                <p id="section-6.1-10.3.2.3.1">The 'signature' field, with value the countersignature.<a href="#section-6.1-10.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-6.1-10.3.3">
The countersignature is computed as defined in <span>[<a href="#RFC9338" class="cite xref">RFC9338</a>]</span>, by using the private key of the Publisher as signing key, and by means of the Signature Algorithm used in the group. The fields of the Countersign_structure are populated as follows:<a href="#section-6.1-10.3.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-10.3.4.1">
                <p id="section-6.1-10.3.4.1.1">'context' takes "CounterSignature".<a href="#section-6.1-10.3.4.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-10.3.4.2">
                <p id="section-6.1-10.3.4.2.1">'body_protected' takes the serialized parameters from the 'protected' field of the COSE_Encrypt0 object, i.e., the 'alg' parameter.<a href="#section-6.1-10.3.4.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-10.3.4.3">
                <p id="section-6.1-10.3.4.3.1">'sign_protected' takes the serialized parameters from the 'protected' field of the 'Countersignature version 2' parameter, i.e., the 'alg' parameter.<a href="#section-6.1-10.3.4.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-10.3.4.4">
                <p id="section-6.1-10.3.4.4.1">'external_aad is not supplied.<a href="#section-6.1-10.3.4.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-10.3.4.5">
                <p id="section-6.1-10.3.4.5.1">'payload' is the ciphertext of the COSE_Encrypt0 object (see below).<a href="#section-6.1-10.3.4.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.1-11">The 'ciphertext' field specifies the ciphertext computed over the topic data to publish. The ciphertext is computed as defined in <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span><span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>, by using the current group key as encryption key, the AEAD Nonce computed as defined in <a href="#ssec-aead-nonce" class="auto internal xref">Section 6.2</a>, the topic data to publish as plaintext, and the Enc_structure populated as follows:<a href="#section-6.1-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-12.1">
            <p id="section-6.1-12.1.1">'context' takes "Encrypt0".<a href="#section-6.1-12.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-12.2">
            <p id="section-6.1-12.2.1">'protected' takes the serialization of the protected parameter 'alg' from the 'protected' field of the COSE_Encrypt0 object.<a href="#section-6.1-12.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-12.3">
            <p id="section-6.1-12.3.1">'external_aad is not supplied.<a href="#section-6.1-12.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="ssec-aead-nonce">
<section id="section-6.2">
        <h3 id="name-aead-nonce">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-aead-nonce" class="section-name selfRef">AEAD Nonce</a>
        </h3>
<p id="section-6.2-1">This section defines how to generate the AEAD nonce used for encrypting and decrypting the COSE_Encrypt0 object protecting the published topic data. This construction is analogous to that used to generate the AEAD nonce in the OSCORE security protocol (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The AEAD nonce for producing or consuming the COSE_Encrypt0 object is constructed as defined below and also shown in <a href="#fig-aead-nonce" class="auto internal xref">Figure 9</a>.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-3">
<li id="section-6.2-3.1">
            <p id="section-6.2-3.1.1">Left-pad the Partial IV (PIV) with zeroes to exactly 5 bytes.<a href="#section-6.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-3.2">
            <p id="section-6.2-3.2.1">Left-pad the Sender ID of the Publisher that generated the Partial IV (ID_PIV) with zeroes to exactly the nonce length of the AEAD algorithm minus 6 bytes.<a href="#section-6.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-3.3">
            <p id="section-6.2-3.3.1">Concatenate the size of the ID_PIV (a single byte S) with the padded ID_PIV and the padded PIV.<a href="#section-6.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-3.4">
            <p id="section-6.2-3.4.1">XOR the result from the previous step with the Base IV.<a href="#section-6.2-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<span id="name-aead-nonce-construction"></span><div id="fig-aead-nonce">
<figure id="figure-9">
          <div class="alignCenter art-text artwork" id="section-6.2-4.1">
<pre>
     &lt;- nonce length minus 6 B -&gt; &lt;-- 5 bytes --&gt;
+---+-------------------+--------+---------+-----+
| S |      padding      | ID_PIV | padding | PIV |-----+
+---+-------------------+--------+---------+-----+     |
                                                       |
 &lt;---------------- nonce length ----------------&gt;      |
+------------------------------------------------+     |
|                    Base IV                     |--&gt;(XOR)
+------------------------------------------------+     |
                                                       |
 &lt;---------------- nonce length ----------------&gt;      |
+------------------------------------------------+     |
|                     Nonce                      |&lt;----+
+------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-aead-nonce-construction" class="selfRef">AEAD Nonce Construction</a>
          </figcaption></figure>
</div>
<p id="section-6.2-5">The construction above only supports AEAD algorithms that use nonces with length equal or greater than 7 bytes. At the same time, it makes it easy to verify that the nonces will be unique when used with the same group key, even though this is shared and used by all the Publishers in the security group. In fact:<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-6.1">
            <p id="section-6.2-6.1.1">Since Publisher's Sender IDs are unique within the security group and they are not reassigned until a group rekeying occurs (see <a href="#join-response" class="auto internal xref">Section 4.1.2</a> and <a href="#rekeying" class="auto internal xref">Section 5</a>), two Publisher Clients cannot share the same tuple (S, padded ID_PIV) by construction.<a href="#section-6.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-6.2">
            <p id="section-6.2-6.2.1">Since a Publisher increments by 1 its Sender Sequence Number after each use that it makes of the current group key, the Publisher  never reuses the same tuple (S, padded ID_PIV, padded PIV) together with the same group key.<a href="#section-6.2-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-6.3">
            <p id="section-6.2-6.3.1">Therefore neither the same Publisher reuses the same AEAD nonce with the same group key, nor any two Publishers use the same AEAD nonce with the same group key.<a href="#section-6.2-6.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="ssec-replay-checks">
<section id="section-6.3">
        <h3 id="name-replay-checks">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-replay-checks" class="section-name selfRef">Replay Checks</a>
        </h3>
<p id="section-6.3-1">In order to protect from replay of published topic data, every Subscriber maintains a Replay Window for each different Publisher in the same group. It is <span class="bcp14">RECOMMENDED</span> that the Replay Window has a default size of 32.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">Upon receiving a topic data published by a given Publisher P, the Subscriber retrieves the Sender ID of P conveyed as 'kid' in the 'Countersignature version 2' parameter of the COSE_Encrypt0 object (see <a href="#oscon" class="auto internal xref">Section 6.1</a>), and determines the Replay Window W_P associated with P.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">The Subscriber <span class="bcp14">MUST</span> verify that, according to W_P, the Sender Sequence Number SN_P specified by the 'Partial IV' parameter of the COSE_Encrypt0 object has not been received before from P.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">If the verification above fails, the Subscriber <span class="bcp14">MUST</span> stop processing the COSE_Encrypt0 object conveying the topic data. If the value of SN_P is strictly smaller than the currently smallest value in W_P, then the Subscriber <span class="bcp14">MUST</span> stop processing the COSE_Encrypt0 object.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3-5">If the verification above succeeds, the Subscriber proceeds with processing the COSE_Encrypt0 object, by verifying the countersignature from P using P's public key as well as by decrypting the COSE_Encrypt0 object using the group key. If both operations succeed, the Subscriber updates W_P as follows:<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-6.1">
            <p id="section-6.3-6.1.1">If SN_P is strictly greater than the currently largest value in W_P, then W_P is updated in order to set SN_P as its largest value.<a href="#section-6.3-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-6.2">
            <p id="section-6.3-6.2.1">SN_P is marked to denote that it has been received.<a href="#section-6.3-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.3-7">The operation of validating the 'Partial IV' and updating the Replay Window <span class="bcp14">MUST</span> be atomic.<a href="#section-6.3-7" class="pilcrow">¶</a></p>
<p id="section-6.3-8">Upon installing a new group key (e.g., due to a group rekeying performed by the KDC, see <a href="#rekeying" class="auto internal xref">Section 5</a>) or upon receiving published topic data from a given Publisher for the first time, the Subscriber initializes the Replay Window corresponding to that Publisher, i.e., the smallest value of the Replay Window is set to 0.<a href="#section-6.3-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="mqtt-pubsub">
<section id="section-7">
      <h2 id="name-applicability-to-the-mqtt-p">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-applicability-to-the-mqtt-p" class="section-name selfRef">Applicability to the MQTT Pub-Sub Profile</a>
      </h2>
<p id="section-7-1">This section describes how this profile can be applicable to the MQTT protocol <span>[<a href="#MQTT-OASIS-Standard-v5" class="cite xref">MQTT-OASIS-Standard-v5</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The MQTT clients would go through steps similar to those performed by the CoAP clients, and the payload of the MQTT PUBLISH messages is protected using COSE. The MQTT clients need to use CoAP for communicating with the KDC, in order to join security groups and be part of the pairwise rekeying initiated by the KDC.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">The discovery of the AS is defined in <span><a href="https://rfc-editor.org/rfc/rfc9431#section-2.4.1" class="relref">Section 2.4.1</a> of [<a href="#RFC9431" class="cite xref">RFC9431</a>]</span> for MQTT v5 clients, and it is not supported for MQTT v3 clients. $SYS/ has been widely adopted as a prefix to topics that contain server-specific information or control APIs, and may be used for discovering topics and the KDC.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">In the Join Response from the KDC to a Client (see <a href="#join-response" class="auto internal xref">Section 4.1.2</a>), the 'ace-groupcomm-profile' parameter has value "mqtt_pubsub_app", which is registered in <a href="#iana-profile" class="auto internal xref">Section 9.2</a>.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">Both Publishers and Subscribers <span class="bcp14">MUST</span> authorise to the Broker with their respective tokens, as described in <span>[<a href="#RFC9431" class="cite xref">RFC9431</a>]</span>. A Publisher sends PUBLISH messages for a given topic and protects the payload with the corresponding key for the associated security group. A Subscriber may send SUBSCRIBE messages with one or multiple topic filters. A topic filter may correspond to multiple topics. The Broker forwards all PUBLISH messages to all authorised Subscribers, including the retained messages.<a href="#section-7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">Security considerations for this profile are inherited from <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, the ACE framework for Authentication and Authorization <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, and the specific transport profile of ACE used, such as <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span> and <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The following security considerations also apply for this profile.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">Consistent with the intended group-confidentiality model, each Client in a security group is able to decrypt the data published in the topic(s) associated with that group, by using the symmetric group key that is shared with all the other group members.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">At the same time, source authentication of the published topic data is achieved by means of a digital signature, which the Publisher of the data in question computes with its private key and embeds in the published data. This ensures integrity of the published topic data as well as its origin, thus preventing a group member from impersonating another one.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">To this end, both Publishers and Subscribers rely on asymmetric cryptography, while Subscribers must be able to access the public keys of all the Publishers to a specific topic in order to verify the signature over the published topic data. This might make the message exchange quite heavy for small constrained devices.<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">The Broker is only trusted with verifying that a Publisher is authorised to publish on a certain topic, and with distributing that data only to the Subscribers authorised to obtain it. However, the Broker is not trusted with the published data in itself, which the Broker cannot read or modify as it does not have access to the group key required for decrypting the data.<a href="#section-8-6" class="pilcrow">¶</a></p>
<p id="section-8-7">With respect to the reusage of nonces for Proof-of-Possession input, the same considerations apply as in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#section-8-7" class="pilcrow">¶</a></p>
<p id="section-8-8">Access tokens might have to be revoked before their expiration time. <span>[<a href="#I-D.ietf-ace-revoked-token-notification" class="cite xref">I-D.ietf-ace-revoked-token-notification</a>]</span> provides a list of possible circumstances where this can happen, and specifies a method that an Authorization Server can use in order to notify the KDC, the Broker, and the Clients about pertaining access tokens that have been revoked but are not expired yet.<a href="#section-8-8" class="pilcrow">¶</a></p>
<p id="section-8-9">Clients can be excluded from future communications related to a topic, by appropriately re-keying the group associated with the topic in question.<a href="#section-8-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">Note to RFC Editor: Please replace "[RFC-XXXX]" with the RFC number of this document and delete this paragraph.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">This document has the following actions for IANA.<a href="#section-9-2" class="pilcrow">¶</a></p>
<div id="iana-ace-groupcomm-key">
<section id="section-9.1">
        <h3 id="name-ace-groupcomm-key-types">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-ace-groupcomm-key-types" class="section-name selfRef">ACE Groupcomm Key Types</a>
        </h3>
<p id="section-9.1-1">IANA is asked to register the following entry in the "ACE Groupcomm Key Types" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-11.8" class="relref">Section 11.8</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-2.1">
            <p id="section-9.1-2.1.1">Name: Group_PubSub_Keying_Material<a href="#section-9.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-2.2">
            <p id="section-9.1-2.2.1">Key Type Value: GROUPCOMM_KEY_TBD<a href="#section-9.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-2.3">
            <p id="section-9.1-2.3.1">Profile: coap_group_pubsub_app or mqtt_pubsub_app (<a href="#iana-profile" class="auto internal xref">Section 9.2</a> of [RFC-XXXX]).<a href="#section-9.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-2.4">
            <p id="section-9.1-2.4.1">Description: Encoded as described in <a href="#join-response" class="auto internal xref">Section 4.1.2</a> of [RFC-XXXX].<a href="#section-9.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-2.5">
            <p id="section-9.1-2.5.1">References: <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span>, <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>, [RFC-XXXX]<a href="#section-9.1-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-profile">
<section id="section-9.2">
        <h3 id="name-ace-groupcomm-profiles">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-ace-groupcomm-profiles" class="section-name selfRef">ACE Groupcomm Profiles</a>
        </h3>
<p id="section-9.2-1">IANA is asked to register the following entries in the "ACE Groupcomm Profiles" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-11.9" class="relref">Section 11.9</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-2.1">
            <p id="section-9.2-2.1.1">Name: coap_group_pubsub_app<a href="#section-9.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-2.2">
            <p id="section-9.2-2.2.1">Description: Application profile to provision keying material for participating in group communication based on the Pub-Sub architecture <span>[<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span> for CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> and protected with COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span><span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span><span>[<a href="#RFC9338" class="cite xref">RFC9338</a>]</span>.<a href="#section-9.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-2.3">
            <p id="section-9.2-2.3.1">CBOR Value: TBD<a href="#section-9.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-2.4">
            <p id="section-9.2-2.4.1">Reference: [RFC-XXXX]<a href="#section-9.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.2-3"><br></p>
<ul class="normal">
<li class="normal" id="section-9.2-4.1">
            <p id="section-9.2-4.1.1">Name: mqtt_pubsub_app<a href="#section-9.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-4.2">
            <p id="section-9.2-4.2.1">Description: Application profile to provision keying material for participating in group communication based on the Pub-Sub MQTT protocol MQTT protocol <span>[<a href="#MQTT-OASIS-Standard-v5" class="cite xref">MQTT-OASIS-Standard-v5</a>]</span> and protected with COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span><span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span><span>[<a href="#RFC9338" class="cite xref">RFC9338</a>]</span>.<a href="#section-9.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-4.3">
            <p id="section-9.2-4.3.1">CBOR Value: TBD<a href="#section-9.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-4.4">
            <p id="section-9.2-4.4.1">Reference: [RFC-XXXX]<a href="#section-9.2-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="core_rt">
<section id="section-9.3">
        <h3 id="name-core-resource-type">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-core-resource-type" class="section-name selfRef">CoRE Resource Type</a>
        </h3>
<p id="section-9.3-1">IANA is asked to register the following entry in the "Resource Type (rt=) Link Target Attribute Values" registry within the "Constrained Restful Environments (CoRE) Parameters" registry group.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3-2.1">
            <p id="section-9.3-2.1.1">Value: "core.ps.gm"<a href="#section-9.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.3-2.2">
            <p id="section-9.3-2.2.1">Description: Group-membership resource for Pub-Sub communication.<a href="#section-9.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.3-2.3">
            <p id="section-9.3-2.3.1">Reference: [RFC-XXXX]<a href="#section-9.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.3-3">Clients can use this resource type to discover a group membership resource at the KDC.<a href="#section-9.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="aif">
<section id="section-9.4">
        <h3 id="name-aif-media-type-sub-paramete">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-aif-media-type-sub-paramete" class="section-name selfRef">AIF Media-Type Sub-Parameters</a>
        </h3>
<p id="section-9.4-1">For the media-types application/aif+cbor and application/aif+json defined in <span><a href="https://rfc-editor.org/rfc/rfc9237#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC9237" class="cite xref">RFC9237</a>]</span>, IANA is requested to register the following entries for the two media-type parameters Toid and Tperm, in the respective sub-registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9237#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC9237" class="cite xref">RFC9237</a>]</span> within the "MIME Media Type Sub-Parameter" registry group.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4-2.1">
            <p id="section-9.4-2.1.1">Parameter: Toid<a href="#section-9.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.4-2.2">
            <p id="section-9.4-2.2.1">Name: pubsub-topic<a href="#section-9.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.4-2.3">
            <p id="section-9.4-2.3.1">Description/Specification: Name of one application group (topic) or of a corresponding security group.<a href="#section-9.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.4-2.4">
            <p id="section-9.4-2.4.1">Reference: [RFC-XXXX]<a href="#section-9.4-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.4-3"><br></p>
<ul class="normal">
<li class="normal" id="section-9.4-4.1">
            <p id="section-9.4-4.1.1">Parameter: Tperm<a href="#section-9.4-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.4-4.2">
            <p id="section-9.4-4.2.1">Name: pubsub-perm<a href="#section-9.4-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.4-4.3">
            <p id="section-9.4-4.3.1">Description/Specification: Permissions pertaining to application groups (topics) or to corresponding security groups.<a href="#section-9.4-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.4-4.4">
            <p id="section-9.4-4.4.1">Reference: [RFC-XXXX]<a href="#section-9.4-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="content_formats">
<section id="section-9.5">
        <h3 id="name-coap-content-formats">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-coap-content-formats" class="section-name selfRef">CoAP Content-Formats</a>
        </h3>
<p id="section-9.5-1">IANA is asked to register the following entries to the "CoAP Content-Formats" registry within the "Constrained RESTful Environments (CoRE) Parameters" registry group.<a href="#section-9.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.5-2.1">
            <p id="section-9.5-2.1.1">Content Type: application/aif+cbor;Toid="pubsub-topic",Tperm="pubsub-perm"<a href="#section-9.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.5-2.2">
            <p id="section-9.5-2.2.1">Content Coding: -<a href="#section-9.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.5-2.3">
            <p id="section-9.5-2.3.1">ID: 294 (suggested)<a href="#section-9.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.5-2.4">
            <p id="section-9.5-2.4.1">Reference: [RFC-XXXX]<a href="#section-9.5-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.5-3"><br></p>
<ul class="normal">
<li class="normal" id="section-9.5-4.1">
            <p id="section-9.5-4.1.1">Content Type: application/aif+json;Toid="pubsub-topic",Tperm="pubsub-perm"<a href="#section-9.5-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.5-4.2">
            <p id="section-9.5-4.2.1">Content Coding: -<a href="#section-9.5-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.5-4.3">
            <p id="section-9.5-4.3.1">ID: 295 (suggested)<a href="#section-9.5-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.5-4.4">
            <p id="section-9.5-4.4.1">Reference: [RFC-XXXX]<a href="#section-9.5-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="tls_exporter">
<section id="section-9.6">
        <h3 id="name-tls-exporter-labels">
<a href="#section-9.6" class="section-number selfRef">9.6. </a><a href="#name-tls-exporter-labels" class="section-name selfRef">TLS Exporter Labels</a>
        </h3>
<p id="section-9.6-1">IANA is asked to register the following entry to the "TLS Exporter Labels" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc5705#section-6" class="relref">Section 6</a> of [<a href="#RFC5705" class="cite xref">RFC5705</a>]</span> and updated in <span><a href="https://rfc-editor.org/rfc/rfc8447#section-12" class="relref">Section 12</a> of [<a href="#RFC8447" class="cite xref">RFC8447</a>]</span>.<a href="#section-9.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.6-2.1">
            <p id="section-9.6-2.1.1">Value: EXPORTER-ACE-Sign-Challenge-pubsub-app<a href="#section-9.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.6-2.2">
            <p id="section-9.6-2.2.1">DTLS-OK: Y<a href="#section-9.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.6-2.3">
            <p id="section-9.6-2.3.1">Recommended: N<a href="#section-9.6-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.6-2.4">
            <p id="section-9.6-2.4.1">Reference: <a href="#pop" class="auto internal xref">Section 4.1.1.2</a> of [RFC-XXXX]<a href="#section-9.6-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-core-coap-pubsub">[I-D.ietf-core-coap-pubsub]</dt>
        <dd>
<span class="refAuthor">Jimenez, J.</span>, <span class="refAuthor">Koster, M.</span>, and <span class="refAuthor">A. Keränen</span>, <span class="refTitle">"A publish-subscribe architecture for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-coap-pubsub-16</span>, <time datetime="2025-01-28" class="refDate">28 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-16">https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.cose_algorithms">[IANA.cose_algorithms]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Algorithms"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose">https://www.iana.org/assignments/cose</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.cose_header-parameters">[IANA.cose_header-parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Header Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose">https://www.iana.org/assignments/cose</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.cose_key-type">[IANA.cose_key-type]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Key Types"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose">https://www.iana.org/assignments/cose</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5705">[RFC5705]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"Keying Material Exporters for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 5705</span>, <span class="seriesInfo">DOI 10.17487/RFC5705</span>, <time datetime="2010-03" class="refDate">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5705">https://www.rfc-editor.org/rfc/rfc5705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6347">https://www.rfc-editor.org/rfc/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6690">[RFC6690]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Link Format"</span>, <span class="seriesInfo">RFC 6690</span>, <span class="seriesInfo">DOI 10.17487/RFC6690</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6690">https://www.rfc-editor.org/rfc/rfc6690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7641">[RFC7641]</dt>
        <dd>
<span class="refAuthor">Hartke, K.</span>, <span class="refTitle">"Observing Resources in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7641</span>, <span class="seriesInfo">DOI 10.17487/RFC7641</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7641">https://www.rfc-editor.org/rfc/rfc7641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7925">[RFC7925]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H., Ed.</span> and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things"</span>, <span class="seriesInfo">RFC 7925</span>, <span class="seriesInfo">DOI 10.17487/RFC7925</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7925">https://www.rfc-editor.org/rfc/rfc7925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8447">[RFC8447]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"IANA Registry Updates for TLS and DTLS"</span>, <span class="seriesInfo">RFC 8447</span>, <span class="seriesInfo">DOI 10.17487/RFC8447</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8447">https://www.rfc-editor.org/rfc/rfc8447</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9053">[RFC9053]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9053">https://www.rfc-editor.org/rfc/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9147">https://www.rfc-editor.org/rfc/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9200">[RFC9200]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments Using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="seriesInfo">RFC 9200</span>, <span class="seriesInfo">DOI 10.17487/RFC9200</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9200">https://www.rfc-editor.org/rfc/rfc9200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9237">[RFC9237]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"An Authorization Information Format (AIF) for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9237</span>, <span class="seriesInfo">DOI 10.17487/RFC9237</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9237">https://www.rfc-editor.org/rfc/rfc9237</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9277">[RFC9277]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span> and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"On Stable Storage for Items in Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 9277</span>, <span class="seriesInfo">DOI 10.17487/RFC9277</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9277">https://www.rfc-editor.org/rfc/rfc9277</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9290">[RFC9290]</dt>
        <dd>
<span class="refAuthor">Fossati, T.</span> and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Problem Details for Constrained Application Protocol (CoAP) APIs"</span>, <span class="seriesInfo">RFC 9290</span>, <span class="seriesInfo">DOI 10.17487/RFC9290</span>, <time datetime="2022-10" class="refDate">October 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9290">https://www.rfc-editor.org/rfc/rfc9290</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9338">[RFC9338]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Countersignatures"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9338</span>, <span class="seriesInfo">DOI 10.17487/RFC9338</span>, <time datetime="2022-12" class="refDate">December 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9338">https://www.rfc-editor.org/rfc/rfc9338</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9594">[RFC9594]</dt>
      <dd>
<span class="refAuthor">Palombini, F.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Key Provisioning for Group Communication Using Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9594</span>, <span class="seriesInfo">DOI 10.17487/RFC9594</span>, <time datetime="2024-09" class="refDate">September 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9594">https://www.rfc-editor.org/rfc/rfc9594</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-edhoc-oscore-profile">[I-D.ietf-ace-edhoc-oscore-profile]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Tiloca, M.</span>, and <span class="refAuthor">R. Höglund</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC) and Object Security for Constrained Environments (OSCORE) Profile for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-edhoc-oscore-profile-06</span>, <time datetime="2024-10-21" class="refDate">21 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-edhoc-oscore-profile-06">https://datatracker.ietf.org/doc/html/draft-ietf-ace-edhoc-oscore-profile-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-key-groupcomm-oscore">[I-D.ietf-ace-key-groupcomm-oscore]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Park, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Key Management for OSCORE Groups in ACE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-key-groupcomm-oscore-16</span>, <time datetime="2023-03-06" class="refDate">6 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-16">https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-revoked-token-notification">[I-D.ietf-ace-revoked-token-notification]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Echeverria, S.</span>, and <span class="refAuthor">G. Lewis</span>, <span class="refTitle">"Notification of Revoked Access Tokens in the Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-revoked-token-notification-09</span>, <time datetime="2024-09-22" class="refDate">22 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-revoked-token-notification-09">https://datatracker.ietf.org/doc/html/draft-ietf-ace-revoked-token-notification-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-cbor-encoded-cert">[I-D.ietf-cose-cbor-encoded-cert]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Höglund, J.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-12</span>, <time datetime="2025-01-08" class="refDate">8 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-12">https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MQTT-OASIS-Standard-v5">[MQTT-OASIS-Standard-v5]</dt>
        <dd>
<span class="refAuthor">Banks, A.</span>, <span class="refAuthor">Briggs, E.</span>, <span class="refAuthor">Borgendale, K.</span>, and <span class="refAuthor">R. Gupta</span>, <span class="refTitle">"OASIS Standard MQTT Version 5.0"</span>, <time datetime="2017" class="refDate">2017</time>, <span>&lt;<a href="http://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html">http://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8613">https://www.rfc-editor.org/rfc/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9202">[RFC9202]</dt>
        <dd>
<span class="refAuthor">Gerdes, S.</span>, <span class="refAuthor">Bergmann, O.</span>, <span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9202</span>, <span class="seriesInfo">DOI 10.17487/RFC9202</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9202">https://www.rfc-editor.org/rfc/rfc9202</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9203">[RFC9203]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">M. Gunnarsson</span>, <span class="refTitle">"The Object Security for Constrained RESTful Environments (OSCORE) Profile of the Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="seriesInfo">RFC 9203</span>, <span class="seriesInfo">DOI 10.17487/RFC9203</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9203">https://www.rfc-editor.org/rfc/rfc9203</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9431">[RFC9431]</dt>
      <dd>
<span class="refAuthor">Sengul, C.</span> and <span class="refAuthor">A. Kirby</span>, <span class="refTitle">"Message Queuing Telemetry Transport (MQTT) and Transport Layer Security (TLS) Profile of Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="seriesInfo">RFC 9431</span>, <span class="seriesInfo">DOI 10.17487/RFC9431</span>, <time datetime="2023-07" class="refDate">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9431">https://www.rfc-editor.org/rfc/rfc9431</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="groupcomm_requirements">
<section id="appendix-A">
      <h2 id="name-requirements-on-application">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-requirements-on-application" class="section-name selfRef">Requirements on Application Profiles</a>
      </h2>
<p id="appendix-A-1">This section lists how this application profile of ACE addresses the requirements defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#appendix-A" class="relref">Appendix A</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="mandatory-to-address-requirements">
<section id="appendix-A.1">
        <h3 id="name-mandatory-to-address-requir">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-mandatory-to-address-requir" class="section-name selfRef">Mandatory-to-Address Requirements</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.1-1.1">
            <p id="appendix-A.1-1.1.1">REQ1: Specify the format and encoding of scope. This includes defining the set of possible roles and their identifiers, as well as the corresponding encoding to use in the scope entries according to the used scope format: see <a href="#scope" class="auto internal xref">Section 3.4.1</a>.<a href="#appendix-A.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.2">
            <p id="appendix-A.1-1.2.1">REQ2: If scope uses AIF, register its specific instance of "Toid" and "Tperm" as media type parameters and a corresponding Content-Format, as per the guidelines in <span>[<a href="#RFC9237" class="cite xref">RFC9237</a>]</span>: see <a href="#aif" class="auto internal xref">Section 9.4</a> and <a href="#content_formats" class="auto internal xref">Section 9.5</a>.<a href="#appendix-A.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.3">
            <p id="appendix-A.1-1.3.1">REQ3: If used, specify the acceptable values for the 'sign_alg' parameter: values from the "Value" column of the "COSE Algorithms" registry <span>[<a href="#IANA.cose_algorithms" class="cite xref">IANA.cose_algorithms</a>]</span>.<a href="#appendix-A.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.4">
            <p id="appendix-A.1-1.4.1">REQ4: If used, specify the acceptable values and structure for the 'sign_parameters' parameter: values and structure from the COSE algorithm capabilities as specified in the "COSE Algorithms" registry <span>[<a href="#IANA.cose_algorithms" class="cite xref">IANA.cose_algorithms</a>]</span>.<a href="#appendix-A.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.5">
            <p id="appendix-A.1-1.5.1">REQ5: If used, specify the acceptable values and structure for the 'sign_key_parameters' parameter: values and structure from the COSE key type capabilities as specified in the "COSE Key Types" registry <span>[<a href="#IANA.cose_key-type" class="cite xref">IANA.cose_key-type</a>]</span>.<a href="#appendix-A.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.6">
            <p id="appendix-A.1-1.6.1">REQ6: Specify the acceptable formats for authentication credentials and, if applicable, the acceptable values for the 'cred_fmt' parameter: acceptable formats explicitly provide the public key as well as the comprehensive set of information related to the public key algorithm (see <a href="#token-post" class="auto internal xref">Section 3.6</a> and <a href="#join-response" class="auto internal xref">Section 4.1.2</a>). Consistent acceptable values for 'cred_fmt' are taken from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#IANA.cose_header-parameters" class="cite xref">IANA.cose_header-parameters</a>]</span>.<a href="#appendix-A.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.7">
            <p id="appendix-A.1-1.7.1">REQ7: If the value of the GROUPNAME URI path and the group name in the access token scope ('gname') are not required to coincide, specify the mechanism to map the GROUPNAME value in the URI to the group name: not applicable; a perfect matching is required.<a href="#appendix-A.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.8">
            <p id="appendix-A.1-1.8.1">REQ8: Define whether the KDC has an authentication credential as required for the correct group operation and if this has to be provided through the 'kdc_cred' parameter: optional, see <a href="#join-response" class="auto internal xref">Section 4.1.2</a>.<a href="#appendix-A.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.9">
            <p id="appendix-A.1-1.9.1">REQ9: Specify if any part of the KDC interface as defined in <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> is not supported by the KDC: some are left optional, see <a href="#kdc-interface" class="auto internal xref">Section 4</a>.<a href="#appendix-A.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.10">
            <p id="appendix-A.1-1.10.1">REQ10: Register a Resource Type for the group-membership resources, which is used to discover the correct URL for sending a Join Request to the KDC: the Resource Type (rt=) Link Target Attribute value "core.ps.gm" is registered in <a href="#core_rt" class="auto internal xref">Section 9.3</a>.<a href="#appendix-A.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.11">
            <p id="appendix-A.1-1.11.1">REQ11: Define what specific actions (e.g., CoAP methods) are allowed on each resource accessible through the KDC interface, depending on: whether the Client is a current group member; the roles that a Client is authorised to take as per the obtained access token; and the roles that the Client has as a current group member: see <a href="#kdc-interface" class="auto internal xref">Section 4</a> of this document.<a href="#appendix-A.1-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.12">
            <p id="appendix-A.1-1.12.1">REQ12: Categorize possible newly defined operations for Clients into primary operations expected to be minimally supported and secondary operations, and provide accompanying considerations: none added.<a href="#appendix-A.1-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.13">
            <p id="appendix-A.1-1.13.1">REQ13: Specify the encoding of group identifiers: CBOR byte string, with value used also to identify the current group key used in the security group (see <a href="#join-response" class="auto internal xref">Section 4.1.2</a>).<a href="#appendix-A.1-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.14">
            <p id="appendix-A.1-1.14.1">REQ14: Specify the approaches used to compute and verify the PoP evidence to include in the 'client_cred_verify' parameter and which of those approaches is used in which case: see <a href="#pop" class="auto internal xref">Section 4.1.1.2</a>.<a href="#appendix-A.1-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.15">
            <p id="appendix-A.1-1.15.1">REQ15: Specify how the nonce N_S is generated, if the access token is not provided to the KDC through the Token Transfer Request sent to the /authz-info endpoint (e.g., the access token is instead transferred during the establishment of a secure communication association): see <a href="#pop" class="auto internal xref">Section 4.1.1.2</a>.<a href="#appendix-A.1-1.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.16">
            <p id="appendix-A.1-1.16.1">REQ16: Define the initial value of the version number for the group keying material: the initial value <span class="bcp14">MUST</span> be set to 0 (see <a href="#join-response" class="auto internal xref">Section 4.1.2</a>).<a href="#appendix-A.1-1.16.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.17">
            <p id="appendix-A.1-1.17.1">REQ17: Specify the format of the group keying material that is conveyed in the 'key' parameter: see <a href="#join-response" class="auto internal xref">Section 4.1.2</a>.<a href="#appendix-A.1-1.17.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.18">
            <p id="appendix-A.1-1.18.1">REQ18: Specify the acceptable values of the 'gkty' parameter. For each of them, register a corresponding entry in the "ACE Groupcomm Key Types" IANA registry if such an entry does not exist already: Group_PubSub_Keying_Material, see <a href="#join-response" class="auto internal xref">Section 4.1.2</a> and <a href="#iana-ace-groupcomm-key" class="auto internal xref">Section 9.1</a>.<a href="#appendix-A.1-1.18.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.19">
            <p id="appendix-A.1-1.19.1">REQ19: Specify and register the application profile identifier: coap_group_pubsub_app (see <a href="#join-response" class="auto internal xref">Section 4.1.2</a> and <a href="#iana-profile" class="auto internal xref">Section 9.2</a>) and mqtt_pubsub_app (see <a href="#mqtt-pubsub" class="auto internal xref">Section 7</a> and <a href="#iana-profile" class="auto internal xref">Section 9.2</a>).<a href="#appendix-A.1-1.19.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.20">
            <p id="appendix-A.1-1.20.1">REQ20: If used, specify the format and default values of the entries of the CBOR map to include in the 'group_policies' parameter: not applicable.<a href="#appendix-A.1-1.20.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.21">
            <p id="appendix-A.1-1.21.1">REQ21: Specify the approaches used to compute and verify the PoP evidence to include in the 'kdc_cred_verify' parameter and which of those approaches is used in which case. If external signature verifiers are supported, specify how those provide a nonce to the KDC to be used for computing the PoP evidence: see <a href="#join-response" class="auto internal xref">Section 4.1.2</a>.<a href="#appendix-A.1-1.21.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.22">
            <p id="appendix-A.1-1.22.1">REQ22: Specify the communication protocol that members of the group use to communicate with each other (e.g., CoAP for group communication): CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, used for Pub-Sub communications as defined in <span>[<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>.<a href="#appendix-A.1-1.22.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.23">
            <p id="appendix-A.1-1.23.1">REQ23: Specify the security protocol that members of the group use to protect the group communication (e.g., Group OSCORE). This must provide encryption, integrity, and replay protection: Publishers in a group use a symmetric group key to protect published topic data as a COSE_Encrypt0 object, per the AEAD algorithm specified by the KDC. A Publisher also produces a COSE countersignature of the COSE_Encrypt0 object by using its private key, per the signature algorithm specified by the KDC.<a href="#appendix-A.1-1.23.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.24">
            <p id="appendix-A.1-1.24.1">REQ24: Specify how the communication is secured between the Client and the KDC. Optionally, specify a transport profile of ACE <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> to use between the Client and the KDC: ACE transport profile such as for DTLS <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span> or OSCORE <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>.<a href="#appendix-A.1-1.24.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.25">
            <p id="appendix-A.1-1.25.1">REQ25: Specify the format of the node identifiers of group members: the Sender ID defined in <a href="#join-response" class="auto internal xref">Section 4.1.2</a>.<a href="#appendix-A.1-1.25.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.26">
            <p id="appendix-A.1-1.26.1">REQ26: Specify policies at the KDC to handle node identifiers that are included in the 'get_creds' parameter but are not associated with any current group member: see <a href="#query" class="auto internal xref">Section 4.2.1</a>.<a href="#appendix-A.1-1.26.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.27">
            <p id="appendix-A.1-1.27.1">REQ27: Specify the format of (newly generated) individual keying material for group members or of the information to derive such keying material, as well as the corresponding CBOR map key that has to be registered in the "ACE Groupcomm Parameters" registry: see <a href="#sec-key-renewal-request" class="auto internal xref">Section 4.2.2</a>.<a href="#appendix-A.1-1.27.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.28">
            <p id="appendix-A.1-1.28.1">REQ28: Specify which CBOR tag is used for identifying the semantics of binary scopes, or register a new CBOR tag if a suitable one does not exist already: see <a href="#as-response" class="auto internal xref">Section 3.5</a> and <a href="#content_formats" class="auto internal xref">Section 9.5</a>.<a href="#appendix-A.1-1.28.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.29">
            <p id="appendix-A.1-1.29.1">REQ29: Categorize newly defined parameters according to the same criteria of <span><a href="https://rfc-editor.org/rfc/rfc9594#section-8" class="relref">Section 8</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>: a Publisher Client <span class="bcp14">MUST</span> support 'group_SenderId' in 'key'; see <a href="#join-response" class="auto internal xref">Section 4.1.2</a>.<a href="#appendix-A.1-1.29.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.30">
            <p id="appendix-A.1-1.30.1">REQ30: Define whether Clients must, should, or may support the conditional parameters defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-8" class="relref">Section 8</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> and under which circumstances: a Publisher Client <span class="bcp14">MUST</span> support the client_cred', 'cnonce', and 'client_cred_verify' parameters (see <a href="#join-request" class="auto internal xref">Section 4.1.1</a>). A Publisher Client that provides the access token to the KDC through the /authz-info endpoint <span class="bcp14">MUST</span> support the parameter 'kdcchallenge' (see <a href="#token-post" class="auto internal xref">Section 3.6</a>).<a href="#appendix-A.1-1.30.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="optional-to-address-requirements">
<section id="appendix-A.2">
        <h3 id="name-optional-to-address-require">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-optional-to-address-require" class="section-name selfRef">Optional-to-Address Requirements</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.2-1.1">
            <p id="appendix-A.2-1.1.1">OPT1: Optionally, if the textual format of scope is used, specify CBOR values to use for abbreviating the role identifiers in the group: not applicable.<a href="#appendix-A.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.2">
            <p id="appendix-A.2-1.2.1">OPT2: Optionally, specify the additional parameters used in the exchange of Token Transfer Request and Response: none are defined.<a href="#appendix-A.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.3">
            <p id="appendix-A.2-1.3.1">OPT3: Optionally, specify the negotiation of parameter values for signature algorithm and signature keys, if the 'sign_info' parameter is not used: see <a href="#token-post" class="auto internal xref">Section 3.6</a>.<a href="#appendix-A.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.4">
            <p id="appendix-A.2-1.4.1">OPT4: Optionally, specify possible or required payload formats for specific error cases: see <a href="#join-error" class="auto internal xref">Section 4.1.3</a>.<a href="#appendix-A.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.5">
            <p id="appendix-A.2-1.5.1">OPT5: Optionally, specify additional identifiers of error types as values of the 'error-id' field within the Custom Problem Detail entry 'ace-groupcomm-error': no.<a href="#appendix-A.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.6">
            <p id="appendix-A.2-1.6.1">OPT6: Optionally, specify the encoding of the 'creds_repo' parameter if the default one is not used: no.<a href="#appendix-A.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.7">
            <p id="appendix-A.2-1.7.1">OPT7: Optionally, specify the functionalities implemented at the resource hosted by the Client at the URI indicated in the 'control_uri' parameter, including the encoding of exchanged messages and other details: no.<a href="#appendix-A.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.8">
            <p id="appendix-A.2-1.8.1">OPT8: Optionally, specify the behavior of the POST handler of group-membership resources, for the case when it fails to retrieve an authentication credential for the specific Client: The KDC <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response to the Join Request (see <a href="#join-error" class="auto internal xref">Section 4.1.3</a>).<a href="#appendix-A.2-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.9">
            <p id="appendix-A.2-1.9.1">OPT9: Optionally, define a default group rekeying scheme to refer to in case the 'rekeying_scheme' parameter is not included in the Join Response: the "Point-to-Point" rekeying scheme registered in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-11.13" class="relref">Section 11.13</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#appendix-A.2-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.10">
            <p id="appendix-A.2-1.10.1">OPT10: Optionally, specify the functionalities implemented at the resource hosted by the Client at the URI indicated in the 'control_group_uri' parameter, including the encoding of exchanged messages and other details: no.<a href="#appendix-A.2-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.11">
            <p id="appendix-A.2-1.11.1">OPT11: Optionally, specify policies that instruct Clients to retain messages and for how long, if those are unsuccessfully decrypted: no.<a href="#appendix-A.2-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.12">
            <p id="appendix-A.2-1.12.1">OPT12: Optionally, specify for the KDC to perform a group rekeying when receiving a Key Renewal Request, together with or instead of renewing individual keying material: the KDC <span class="bcp14">SHOULD NOT</span> perform a group rekeying, unless already scheduled to occur shortly (see <a href="#sec-key-renewal-request" class="auto internal xref">Section 4.2.2</a>).<a href="#appendix-A.2-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.13">
            <p id="appendix-A.2-1.13.1">OPT13: Optionally, specify how the identifier of a group member's authentication credential is included in requests sent to other group members: no.<a href="#appendix-A.2-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.14">
            <p id="appendix-A.2-1.14.1">OPT14: Optionally, specify additional information to include in rekeying messages for the "Point-to-Point" group rekeying scheme (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-6" class="relref">Section 6</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>): no.<a href="#appendix-A.2-1.14.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-document-updates">
<section id="appendix-B">
      <h2 id="name-document-updates">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="appendix-B-1">This section is to be removed before publishing as an RFC.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="sec-10-11">
<section id="appendix-B.1">
        <h3 id="name-version-10-to-11">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-version-10-to-11" class="section-name selfRef">Version -10 to -11</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.1-1.1">
            <p id="appendix-B.1-1.1.1">Recommended /ps/TOPICNAME as path ot topic resources at the Broker.<a href="#appendix-B.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-1.2">
            <p id="appendix-B.1-1.2.1">The request for a new Sender ID uses the method POST.<a href="#appendix-B.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-1.3">
            <p id="appendix-B.1-1.3.1">Fixed description of ACE Group Error with identifier 4.<a href="#appendix-B.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-1.4">
            <p id="appendix-B.1-1.4.1">Aligned requirement formulation with that in RFC 9594.<a href="#appendix-B.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-1.5">
            <p id="appendix-B.1-1.5.1">Updated references.<a href="#appendix-B.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-1.6">
            <p id="appendix-B.1-1.6.1">Clarifications and editorial improvements.<a href="#appendix-B.1-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-09-10">
<section id="appendix-B.2">
        <h3 id="name-version-09-to-10">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-version-09-to-10" class="section-name selfRef">Version -09 to -10</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.2-1.1">
            <p id="appendix-B.2-1.1.1">More details on the scope format.<a href="#appendix-B.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.2">
            <p id="appendix-B.2-1.2.1">More details in the encoding of the 'key' parameter in the Join Response.<a href="#appendix-B.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.3">
            <p id="appendix-B.2-1.3.1">More details on exchanges between group members and KDC.<a href="#appendix-B.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.4">
            <p id="appendix-B.2-1.4.1">More details on the rekeying process and rekeying messages.<a href="#appendix-B.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.5">
            <p id="appendix-B.2-1.5.1">Defined replay checks at the Subscriber.<a href="#appendix-B.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.6">
            <p id="appendix-B.2-1.6.1">Improved examples.<a href="#appendix-B.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.7">
            <p id="appendix-B.2-1.7.1">Improved security considerations.<a href="#appendix-B.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.8">
            <p id="appendix-B.2-1.8.1">Revised IANA considerations.<a href="#appendix-B.2-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.9">
            <p id="appendix-B.2-1.9.1">Aligned the list of profile requirements with draft-ietf-ace-key-groupcomm.<a href="#appendix-B.2-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.10">
            <p id="appendix-B.2-1.10.1">Clarifications and editorial improvements.<a href="#appendix-B.2-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-08-09">
<section id="appendix-B.3">
        <h3 id="name-version-08-to-09">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-version-08-to-09" class="section-name selfRef">Version -08 to -09</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.3-1.1">
            <p id="appendix-B.3-1.1.1">Improved terminology section.<a href="#appendix-B.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.2">
            <p id="appendix-B.3-1.2.1">Generalized scope format for future, admin-related extensions.<a href="#appendix-B.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.3">
            <p id="appendix-B.3-1.3.1">Improved definition of permissions in the format of scope.<a href="#appendix-B.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.4">
            <p id="appendix-B.3-1.4.1">Clarified alternative computing of N_S Challenge when DTLS is used.<a href="#appendix-B.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.5">
            <p id="appendix-B.3-1.5.1">Use of the parameter 'exi' in the Join Response.<a href="#appendix-B.3-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.6">
            <p id="appendix-B.3-1.6.1">Use of RFC 9290 instead of the custom format of error responses.<a href="#appendix-B.3-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.7">
            <p id="appendix-B.3-1.7.1">Fixed construction of the COSE_Encrypt0 object.<a href="#appendix-B.3-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.8">
            <p id="appendix-B.3-1.8.1">Fixed use of the resource type "core.ps.gm".<a href="#appendix-B.3-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.9">
            <p id="appendix-B.3-1.9.1">Updated formulation of profile requirements.<a href="#appendix-B.3-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.10">
            <p id="appendix-B.3-1.10.1">Clarification and editorial improvements.<a href="#appendix-B.3-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-07-08">
<section id="appendix-B.4">
        <h3 id="name-version-07-to-08">
<a href="#appendix-B.4" class="section-number selfRef">B.4. </a><a href="#name-version-07-to-08" class="section-name selfRef">Version -07 to -08</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.4-1.1">
            <p id="appendix-B.4-1.1.1">Revised presentation of the scope format.<a href="#appendix-B.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.4-1.2">
            <p id="appendix-B.4-1.2.1">Revised presentation of the Join Request-Response exchange.<a href="#appendix-B.4-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.4-1.3">
            <p id="appendix-B.4-1.3.1">The 'cnonce' parameter must be present in the Join Request.<a href="#appendix-B.4-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.4-1.4">
            <p id="appendix-B.4-1.4.1">The 'kid' of the group key is used as Group Identifier.<a href="#appendix-B.4-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.4-1.5">
            <p id="appendix-B.4-1.5.1">Relaxed inclusion of the 'peer_roles' parameter.<a href="#appendix-B.4-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.4-1.6">
            <p id="appendix-B.4-1.6.1">More detailed description of the encryption and signing operations.<a href="#appendix-B.4-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.4-1.7">
            <p id="appendix-B.4-1.7.1">Defined construction of the AEAD nonce.<a href="#appendix-B.4-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.4-1.8">
            <p id="appendix-B.4-1.8.1">Clarifications and editorial improvements.<a href="#appendix-B.4-1.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-06-07">
<section id="appendix-B.5">
        <h3 id="name-version-06-to-07">
<a href="#appendix-B.5" class="section-number selfRef">B.5. </a><a href="#name-version-06-to-07" class="section-name selfRef">Version -06 to -07</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.5-1.1">
            <p id="appendix-B.5-1.1.1">Revised abstract and introduction.<a href="#appendix-B.5-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-1.2">
            <p id="appendix-B.5-1.2.1">Clarified use of "application groups".<a href="#appendix-B.5-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-1.3">
            <p id="appendix-B.5-1.3.1">Revised use of protocols and transport profiles with Broker and KDC.<a href="#appendix-B.5-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-1.4">
            <p id="appendix-B.5-1.4.1">Revised overview of the profile and its security associations.<a href="#appendix-B.5-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-1.5">
            <p id="appendix-B.5-1.5.1">Revised presentation of authorization flow.<a href="#appendix-B.5-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-1.6">
            <p id="appendix-B.5-1.6.1">Subscribers cannot be anonymous anymore.<a href="#appendix-B.5-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-1.7">
            <p id="appendix-B.5-1.7.1">Revised scope definition.<a href="#appendix-B.5-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-1.8">
            <p id="appendix-B.5-1.8.1">Revised Join Response.<a href="#appendix-B.5-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-1.9">
            <p id="appendix-B.5-1.9.1">Revised COSE countersignature, COSE encrypt objects.<a href="#appendix-B.5-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-1.10">
            <p id="appendix-B.5-1.10.1">Further clarifications, fixes and editorial improvements.<a href="#appendix-B.5-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">The authors wish to thank <span class="contact-name">Ari Keränen</span>, <span class="contact-name">John Preuß Mattsson</span>, <span class="contact-name">Jim Schaad</span>, <span class="contact-name">Ludwig Seitz</span>, and <span class="contact-name">Göran Selander</span> for the useful discussion and reviews that helped shape this document.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">This work was supported by the Sweden's Innovation Agency VINNOVA within the EUREKA CELTIC-NEXT projects CRITISEC and CYPRESS; and by the H2020 project SIFIS-Home (Grant agreement 952652).<a href="#appendix-C-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Francesca Palombini</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:francesca.palombini@ericsson.com" class="email">francesca.palombini@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Cigdem Sengul</span></div>
<div dir="auto" class="left"><span class="org">Brunel University</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:csengul@acm.org" class="email">csengul@acm.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
